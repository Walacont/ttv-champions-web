<!doctype html>
<html lang="de">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

        <script src="/js/cookie-consent.js"></script>
        <script src="/js/capacitor-init.js"></script>
        <script src="/js/avatar-utils.js"></script>
        <script src="/js/i18n-lite.js"></script>
        <script src="/js/analytics.js"></script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-H2R9ZJYQ06"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-H2R9ZJYQ06');
        </script>

        <title data-i18n="club.pageTitle">Vereinsseite - SC Champions</title>

        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="manifest" href="/manifest.json" />
        <meta name="theme-color" content="#1e3a5f" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="SC Champions" />
        <link rel="apple-touch-icon" href="/icons/icon-152x152-2.png" />
        <meta name="mobile-web-app-capable" content="yes" />

        <link rel="stylesheet" href="/css/tailwind.css" />
        <link rel="stylesheet" href="/vendor/fonts/inter.css" />
        <link rel="stylesheet" href="/vendor/fontawesome/css/all.min.css" />
        <link rel="stylesheet" href="/css/spa-enhancements.css" />
        <link rel="stylesheet" href="/css/mobile-fixes.css" />
        <style>
            body { font-family: 'Inter', sans-serif; }
            #page-loader { display: flex; justify-content: center; align-items: center; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background-color: #f3f4f6; z-index: 9999; }
            #main-content { display: none; }
        </style>
    </head>
    <body class="bg-gray-100 text-gray-800">
        <div id="page-loader">
            <svg class="animate-spin h-10 w-10 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
        </div>

        <!-- Zugriff verweigert / Fehler -->
        <div id="access-denied" class="container mx-auto p-4 sm:p-6 md:p-8 max-w-2xl hidden">
            <div class="bg-white rounded-xl shadow-md p-8 text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-building text-red-600 text-2xl"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-900 mb-2" data-i18n="club.notFound">Verein nicht gefunden</h2>
                <p class="text-gray-500 mb-6" data-i18n="club.pageNotAvailable">Diese Seite ist nicht verfügbar.</p>
                <a href="/dashboard.html" class="inline-flex items-center gap-2 bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">
                    <i class="fas fa-arrow-left"></i> <span data-i18n="club.backToDashboard">Zurück zum Dashboard</span>
                </a>
            </div>
        </div>

        <div id="main-content" class="container mx-auto px-4 sm:px-6 md:px-8 max-w-2xl py-6">

            <!-- Zurück-Link -->
            <a id="back-link" href="/settings.html" class="inline-flex items-center text-indigo-600 hover:text-indigo-800 font-semibold mb-6 text-sm">
                <i class="fas fa-arrow-left mr-2"></i> <span data-i18n="common.back">Zurück</span>
            </a>

            <!-- ══════ Vereins-Header: Logo + Name ══════ -->
            <div class="bg-white rounded-xl shadow-md p-6 mb-4 text-center">
                <div class="relative inline-block mb-4">
                    <img id="club-logo-preview" src="/icons/icon-192x192-2.png" alt="Vereinslogo"
                         class="w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg mx-auto" />
                    <button id="remove-logo-btn" class="absolute -top-1 -right-1 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center shadow hover:bg-red-600 transition hidden">
                        <i class="fas fa-times text-xs"></i>
                    </button>
                </div>

                <!-- Upload (nur Edit) -->
                <label id="logo-upload-area" class="inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-600 text-sm transition cursor-pointer mb-3">
                    <i class="fas fa-camera"></i>
                    <span data-i18n="club.changeLogo">Logo ändern</span>
                    <input type="file" id="logo-upload-input" accept="image/png,image/jpeg,image/svg+xml,image/webp" class="hidden" />
                </label>
                <div id="logo-upload-progress" class="w-48 mx-auto hidden mt-2">
                    <div class="w-full bg-gray-200 rounded-full h-1.5">
                        <div id="logo-progress-bar" class="bg-indigo-600 h-1.5 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Vereinsname (View) -->
                <h1 id="club-name-display" class="text-2xl font-bold text-gray-900 mt-2"></h1>
                <!-- Vereinsname (Edit) -->
                <input type="text" id="club-name-input"
                       class="hidden w-full max-w-sm mx-auto px-4 py-2 mt-2 border border-gray-200 rounded-lg text-center text-lg font-semibold text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                       placeholder="Vereinsname" data-i18n-placeholder="club.clubName" />
            </div>

            <!-- ══════ View: Alle Sparten (read-only) ══════ -->
            <div id="sport-sections-view" class="space-y-4">
                <!-- Wird dynamisch befüllt -->
            </div>

            <!-- ══════ Edit: Eigene Sparte bearbeiten ══════ -->
            <div id="edit-sport-section" class="space-y-4 hidden">
                <!-- Beschreibung -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-1">
                        <i class="fas fa-align-left text-indigo-600 mr-2"></i><span data-i18n="club.description">Beschreibung</span>
                    </h2>
                    <p id="sport-section-hint" class="text-xs text-gray-400 mb-3"></p>
                    <textarea id="club-description-input"
                              class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition resize-none text-sm"
                              rows="4" maxlength="500"
                              placeholder="Beschreibe die Sparte..." data-i18n-placeholder="club.descriptionPlaceholder"></textarea>
                    <p class="text-xs text-gray-400 text-right mt-1"><span id="desc-char-count">0</span>/500</p>
                </div>

                <!-- Trainingszeiten -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-1">
                        <i class="fas fa-clock text-indigo-600 mr-2"></i><span data-i18n="club.trainingTimes">Trainingszeiten</span>
                    </h2>
                    <p id="training-section-hint" class="text-xs text-gray-400 mb-3"></p>
                    <div id="training-times-container" class="space-y-3"></div>
                    <button id="add-training-time-btn"
                            class="mt-4 w-full py-2.5 border-2 border-dashed border-gray-200 rounded-lg text-gray-400 hover:border-indigo-400 hover:text-indigo-600 transition flex items-center justify-center gap-2 text-sm">
                        <i class="fas fa-plus"></i> <span data-i18n="club.addTrainingTime">Trainingszeit hinzufügen</span>
                    </button>
                </div>
            </div>

            <!-- ══════ Kontakt & Adresse ══════ -->
            <!-- View-Modus -->
            <div id="contact-view" class="bg-white rounded-xl shadow-md p-6 mt-4 hidden">
                <h2 class="text-lg font-bold text-gray-800 mb-4">
                    <i class="fas fa-address-card text-indigo-600 mr-2"></i><span data-i18n="club.contactLocation">Kontakt & Standort</span>
                </h2>
                <div id="contact-view-content" class="space-y-3">
                    <!-- Dynamisch -->
                </div>
            </div>

            <!-- Edit-Modus -->
            <div id="contact-edit" class="space-y-4 mt-4 hidden">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-envelope text-indigo-600 mr-2"></i><span data-i18n="club.contact">Kontakt</span>
                    </h2>
                    <div class="space-y-3">
                        <input type="email" id="club-email-input" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="E-Mail-Adresse" data-i18n-placeholder="club.emailPlaceholder" />
                        <input type="tel" id="club-phone-input" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="Telefonnummer (optional)" data-i18n-placeholder="club.phonePlaceholder" />
                        <input type="url" id="club-website-input" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="Website (optional)" data-i18n-placeholder="club.websitePlaceholder" />
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-map-marker-alt text-indigo-600 mr-2"></i><span data-i18n="club.address">Adresse</span>
                    </h2>
                    <div class="space-y-3">
                        <input type="text" id="club-address-input" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="Straße und Hausnummer" data-i18n-placeholder="club.streetPlaceholder" />
                        <div class="flex gap-3">
                            <input type="text" id="club-zip-input" class="w-1/3 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="PLZ" data-i18n-placeholder="club.zipPlaceholder" />
                            <input type="text" id="club-city-input" class="w-2/3 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-sm" placeholder="Stadt" data-i18n-placeholder="club.cityPlaceholder" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- ══════ Vereins-Beiträge (öffentlich) ══════ -->
            <div id="club-posts-section" class="mt-4 hidden">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-newspaper text-indigo-600 mr-2"></i><span data-i18n="club.posts">Beiträge</span>
                    </h2>
                    <div id="club-posts-container" class="space-y-4">
                        <!-- Dynamisch befüllt -->
                    </div>
                    <div id="club-posts-empty" class="hidden text-center py-4">
                        <p class="text-gray-400 text-sm" data-i18n="club.noPosts">Noch keine Beiträge vom Verein.</p>
                    </div>
                </div>
            </div>

            <!-- ══════ Statistik ══════ -->
            <div class="bg-white rounded-xl shadow-md p-6 mt-4">
                <h2 class="text-lg font-bold text-gray-800 mb-4">
                    <i class="fas fa-chart-bar text-indigo-600 mr-2"></i><span data-i18n="club.statistics">Statistik</span>
                </h2>
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-gray-50 rounded-xl p-4 text-center">
                        <p id="stat-members" class="text-2xl font-bold text-indigo-600">0</p>
                        <p class="text-xs text-gray-500 font-medium mt-1" data-i18n="club.members">Mitglieder</p>
                    </div>
                    <div class="bg-gray-50 rounded-xl p-4 text-center">
                        <p id="stat-coaches" class="text-2xl font-bold text-indigo-600">0</p>
                        <p class="text-xs text-gray-500 font-medium mt-1" data-i18n="club.coaches">Trainer</p>
                    </div>
                    <div class="bg-gray-50 rounded-xl p-4 text-center">
                        <p id="stat-matches" class="text-2xl font-bold text-indigo-600">0</p>
                        <p class="text-xs text-gray-500 font-medium mt-1" data-i18n="club.competitions">Wettkämpfe</p>
                    </div>
                </div>
            </div>

            <!-- ══════ Edit-Controls ══════ -->
            <div id="edit-controls" class="mt-6 pb-8">
                <button id="save-club-btn"
                        class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition flex items-center justify-center gap-2 shadow-md">
                    <i class="fas fa-save"></i> <span data-i18n="common.save">Speichern</span>
                </button>
                <div id="save-status" class="hidden text-center py-2 rounded-lg text-sm font-medium mt-3"></div>
            </div>

            <div class="h-6"></div>
        </div>

        <script type="module" src="/js/club-page-supabase.js"></script>
        <script type="module">
            import { initI18n, translatePage, setupAutoTranslate } from '/js/i18n.js';
            await initI18n();
            translatePage();
            setupAutoTranslate();
        </script>
        <script>if(window.trackView)window.trackView('club_page');</script>
    </body>
</html>
