<!doctype html>
<html lang="de">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

        <!-- Cookie Consent & Analytics -->
        <script src="/js/cookie-consent.js"></script>

        <script src="/js/capacitor-init.js"></script>
        <title>Mein Dashboard - SC Champions</title>

        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

        <!-- PWA Meta Tags -->
        <link rel="manifest" href="/manifest.json" />
        <meta name="theme-color" content="#1e3a5f" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="SC Champions" />
        <link rel="apple-touch-icon" href="/icons/icon-152x152.png" />
        <meta name="mobile-web-app-capable" content="yes" />

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-H2R9ZJYQ06"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-H2R9ZJYQ06');
        </script>

        <link rel="stylesheet" href="/css/tailwind.css" />
        <link rel="stylesheet" href="/vendor/fonts/inter.css" />
        <link
            rel="stylesheet"
            href="/vendor/fontawesome/css/all.min.css"
        />
        <link rel="stylesheet" href="/css/spa-enhancements.css" />
        <link rel="stylesheet" href="/css/mobile-fixes.css" />
        <link rel="stylesheet" href="/css/tutorial.css" />
        <script src="/vendor/chart.umd.min.js"></script>
        <script src="/vendor/exceljs.min.js"></script>
        <style>
            /* Fallback for when Tailwind CDN doesn't load */
            .hidden { display: none !important; }
            body {
                font-family: 'Inter', sans-serif;
            }

            /* PWA Standalone Mode - Safe Area for Status Bar */
            @media all and (display-mode: standalone) {
                body {
                    padding-top: env(safe-area-inset-top, 0);
                }
                #main-content {
                    padding-top: env(safe-area-inset-top, 20px);
                }
            }

            /* iOS Safari PWA detection */
            @supports (-webkit-touch-callout: none) {
                @media all and (display-mode: standalone) {
                    body {
                        padding-top: env(safe-area-inset-top, 0);
                    }
                }
            }

            #page-loader {
                display: flex;
                justify-content: center;
                align-items: center;
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background-color: #f3f4f6;
                z-index: 9999;
            }
            #main-content,
            #auth-error-container {
                display: none;
            }
            .tab-active {
                border-color: #4f46e5; /* indigo-600 */
                color: #4f46e5;
                background-color: #eef2ff; /* indigo-50 */
            }
            .modal {
                transition: opacity 0.25s ease;
            }
            .league-icon-active {
                transform: scale(1.1);
                border-color: #4f46e5;
            }
            .league-select-btn-active {
                background-color: #4f46e5;
                color: white;
                border-color: #4f46e5;
            }
            .toggle-btn-active {
                background-color: #4f46e5;
                color: white;
            }

            /* Match type toggle buttons */
            .match-type-toggle {
                background-color: transparent;
                color: #6b7280; /* gray-500 */
            }
            .match-type-toggle.active {
                background-color: #4f46e5; /* indigo-600 */
                color: white;
            }

            .calendar-day-present {
                background-color: #10b981;
                color: white;
                border-color: #059669;
            }
            .calendar-day-today {
                ring: 2px;
                ring-color: #4f46e5;
            }
            .calendar-day:not(.disabled) {
                cursor: pointer;
            }
            .calendar-day:not(.disabled):hover {
                background-color: #eef2ff;
            }

            /* Styles f√ºr das ausklappbare FAQ-Men√º */
            details > summary {
                list-style: none;
            }
            details > summary::-webkit-details-marker {
                display: none;
            }
            details[open] summary svg {
                transform: rotate(180deg);
            }

            /* NEU: Hebt das aktive Item in der Spieler-Liste hervor */
            .player-list-item-active {
                background-color: #eef2ff; /* indigo-50 */
                border-right: 3px solid #4f46e5; /* indigo-600 */
            }
        </style>
    </head>
    <body class="bg-gray-100 text-gray-800">
        <div id="page-loader">
            <div class="text-center">
                <svg
                    class="animate-spin h-10 w-10 text-indigo-600 mx-auto"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                >
                    <circle
                        class="opacity-25"
                        cx="12"
                        cy="12"
                        r="10"
                        stroke="currentColor"
                        stroke-width="4"
                    ></circle>
                    <path
                        class="opacity-75"
                        fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                    ></path>
                </svg>
                <p id="loader-text" class="mt-4 text-sm font-medium text-gray-600">Lade Daten...</p>
            </div>
        </div>

        <div id="auth-error-container" class="hidden items-center justify-center fixed inset-0">
            <div class="text-center p-8 bg-white rounded-lg shadow-md">
                <h2 class="text-2xl font-bold text-red-600 mb-4">Zugriff verweigert</h2>
                <p id="auth-error-message" class="text-gray-700">
                    Die Seite konnte nicht geladen werden.
                </p>
                <button
                    id="error-logout-button"
                    class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                >
                    Zur√ºck zum Login
                </button>
            </div>
        </div>

        <div id="main-content" class="container mx-auto p-4 sm:p-6 md:p-8 max-w-7xl coach-dashboard-content">
            <header class="mb-6">
                <!-- Top Row: Profile + Title + Settings/Logout -->
                <div class="flex justify-between items-start mb-4">
                    <div class="flex items-start gap-3 flex-1">
                        <!-- Profile Picture -->
                        <img id="header-profile-pic" src="" alt="Profilbild"
                             class="h-14 w-14 rounded-full object-cover border-2 border-indigo-200 shadow-md flex-shrink-0">

                        <!-- Title and Club Info -->
                        <div class="flex-1">
                            <h1 class="text-2xl sm:text-3xl font-bold text-gray-900" data-i18n="coachPage.title">
                                Coach Dashboard
                            </h1>
                            <p id="welcome-message" class="text-sm sm:text-base text-gray-600" data-i18n="coachPage.welcomeBack">
                                Willkommen zur√ºck!
                            </p>
                            <p id="header-club-info" class="text-xs sm:text-sm text-gray-500 mt-1">
                                <i class="fas fa-building mr-1"></i><span id="header-club-name" data-i18n="coachPage.loading">Lade...</span>
                            </p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3 sm:space-x-4">
                        <!-- Player View Switch Button -->
                        <a
                            id="switch-to-player-btn"
                            href="/dashboard.html"
                            class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-1.5 px-3 sm:py-2 sm:px-4 text-sm rounded-lg shadow transition-transform transform hover:scale-105"
                            title="Zur Spieler-Ansicht wechseln"
                        >
                            <i class="fas fa-table-tennis mr-1"></i>
                            <span class="hidden sm:inline">Spieler</span>
                        </a>
                        <!-- Notification Bell -->
                        <button
                            id="desktop-notifications-btn"
                            class="relative text-gray-500 hover:text-gray-800 transition-colors"
                            title="Benachrichtigungen"
                        >
                            <i class="far fa-bell text-xl"></i>
                            <span id="desktop-notifications-badge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                        </button>
                        <a
                            href="/settings.html"
                            class="text-gray-500 hover:text-gray-800 transition-colors"
                            title="Einstellungen"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="h-5 w-5 sm:h-6 sm:w-6"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                                ></path>
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                                ></path>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Second Row: Filter-Switcher (Mobile-friendly stacked layout) -->
                <div
                    id="coach-filter-container"
                    class="flex flex-col sm:flex-row sm:flex-wrap items-stretch sm:items-center gap-2 bg-gray-50 border border-gray-200 rounded-lg p-3 shadow-sm"
                >
                    <div class="flex items-center gap-2 flex-1 min-w-0">
                        <label
                            for="subgroup-filter"
                            class="text-sm font-medium text-gray-700 whitespace-nowrap cursor-pointer select-none"
                            onclick="document.getElementById('subgroup-filter').focus(); document.getElementById('subgroup-filter').click();"
                        >
                            üë• Ansicht:
                        </label>
                        <select
                            id="subgroup-filter"
                            class="flex-1 min-w-0 px-3 py-2 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 rounded-md shadow-sm bg-white"
                        >
                            <option value="all">Alle (Gesamtverein)</option>
                        </select>
                    </div>
                    <div id="coach-gender-filter-container" class="flex items-center gap-2 flex-1 sm:flex-none">
                        <label
                            for="coach-gender-filter"
                            class="text-sm font-medium text-gray-700 whitespace-nowrap cursor-pointer select-none"
                            onclick="document.getElementById('coach-gender-filter').focus(); document.getElementById('coach-gender-filter').click();"
                        >
                            ‚öß Geschlecht:
                        </label>
                        <select
                            id="coach-gender-filter"
                            class="flex-1 sm:flex-none px-3 py-2 text-sm border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 rounded-md shadow-sm bg-white"
                        >
                            <option value="all">Alle</option>
                            <option value="male">Jungen/Herren</option>
                            <option value="female">M√§dchen/Damen</option>
                        </select>
                    </div>
                </div>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 max-w-2xl mx-auto">
                <button
                    id="open-player-modal-button"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center justify-center space-x-2"
                >
                    <i class="fas fa-users"></i>
                    <span>Spieler verwalten</span>
                </button>
                <button
                    id="add-offline-player-button"
                    class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center justify-center space-x-2"
                >
                    <i class="fas fa-user-plus"></i>
                    <span>Offline-Spieler erstellen</span>
                </button>
            </div>

            <div class="mb-6 border-b border-gray-200">
                <nav id="main-nav" class="-mb-px flex space-x-6 overflow-x-auto">
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="statistics"
                    >
                        Startseite
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="dashboard"
                    >
                        Rangliste
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="attendance"
                    >
                        Kalender & Anwesenheit
                    </button>
                    <!-- Trainingsplan tab temporarily hidden - will be re-enabled with recurring trainings later
                <button class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="schedule">
                    üìÖ Trainingsplan
                </button>
                -->
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="matches"
                    >
                        Wettkampf
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="points"
                    >
                        Punkte vergeben
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="challenges"
                    >
                        Challenges
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="exercises"
                    >
                        √úbungen
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="video-analysis"
                    >
                        Video-Analyse
                    </button>
                    <button
                        class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
                        data-tab="subgroups"
                    >
                        üë• Gruppen
                    </button>
                </nav>
            </div>

            <main>
                <div id="tab-content-dashboard" class="tab-content">
                    <!-- Upcoming Events Widget for Coaches -->
                    <div id="coach-upcoming-events" class="max-w-3xl mx-auto mb-6"></div>
                </div>

                <div id="tab-content-attendance" class="tab-content hidden">
                    <div class="bg-white p-6 rounded-xl shadow-md max-w-3xl mx-auto">
                        <div class="flex justify-between items-center mb-4">
                            <button id="prev-month-btn" class="p-2 rounded-full hover:bg-gray-200">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h2 id="calendar-month-year" class="text-xl font-bold"></h2>
                            <button id="next-month-btn" class="p-2 rounded-full hover:bg-gray-200">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="flex justify-end gap-2 mb-4">
                            <button
                                id="export-attendance-btn"
                                class="export-btn-mobile bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-2 px-4 rounded-lg shadow transition-all flex items-center gap-2"
                                title="Anwesenheit als Excel exportieren"
                            >
                                <i class="fas fa-file-excel"></i>
                                <span>Excel</span>
                            </button>
                            <button
                                id="export-attendance-summary-btn"
                                class="export-btn-mobile bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 px-4 rounded-lg shadow transition-all flex items-center gap-2"
                                title="Zusammenfassung exportieren"
                            >
                                <i class="fas fa-chart-bar"></i>
                                <span>√úbersicht</span>
                            </button>
                        </div>
                        <div id="export-loading" class="hidden text-center py-2 text-indigo-600">
                            <i class="fas fa-spinner fa-spin mr-2"></i>
                            <span>Excel wird erstellt...</span>
                        </div>
                        <div
                            class="grid grid-cols-7 gap-2 text-center text-sm font-semibold text-gray-500 mb-2"
                        >
                            <div>Mo</div>
                            <div>Di</div>
                            <div>Mi</div>
                            <div>Do</div>
                            <div>Fr</div>
                            <div>Sa</div>
                            <div>So</div>
                        </div>
                        <div id="calendar-grid" class="grid grid-cols-7 gap-2"></div>
                    </div>
                </div>

                <!-- Trainingsplan tab content - hidden for now, will be re-enabled with recurring trainings later
            <div id="tab-content-schedule" class="tab-content hidden">
                <div class="bg-white p-6 rounded-xl shadow-md max-w-4xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">Wiederkehrende Trainings</h2>
                        <button id="add-recurring-training-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>Neues Training</span>
                        </button>
                    </div>

                    <div id="recurring-trainings-list" class="space-y-3">

                    </div>

                    <div id="no-trainings-message" class="text-center py-12 text-gray-500 hidden">
                        <i class="fas fa-calendar-alt text-6xl mb-4 text-gray-300"></i>
                        <p class="text-lg">Noch keine wiederkehrenden Trainings eingerichtet</p>
                        <p class="text-sm mt-2">Klicke auf "Neues Training", um ein wiederkehrendes Training hinzuzuf√ºgen</p>
                    </div>
                </div>
            </div>
            -->

                <div id="tab-content-matches" class="tab-content hidden">
                    <div class="space-y-8">
                        <!-- Saved Pairings Section -->
                        <div class="bg-white p-6 rounded-xl shadow-md max-w-2xl mx-auto">
                            <h2 class="text-xl font-semibold mb-4">Gespeicherte Paarungen</h2>
                            <p class="text-sm text-gray-600 mb-4">
                                Hier siehst du alle gespeicherten Paarungen aus den Trainings. Du
                                kannst entweder das Ergebnis eingeben oder die Paarung verwerfen.
                            </p>
                            <div id="saved-pairings-container" class="space-y-4">
                                <p class="text-center text-gray-500 py-8">
                                    Lade gespeicherte Paarungen...
                                </p>
                            </div>
                        </div>

                        <!-- Coach Match Reporting Form -->
                        <div class="bg-white p-6 rounded-xl shadow-md max-w-2xl mx-auto">
                            <h2 class="text-xl font-semibold mb-4">
                                Wettkampf-Match melden (Coach)
                            </h2>
                            <p class="text-sm text-gray-600 mb-4">
                                W√§hle Spieler aus, um ein Match zu melden. Das System berechnet
                                automatisch einen Handicap-Vorschlag, um das Spiel fairer zu
                                gestalten.
                            </p>
                            <form id="match-form" class="space-y-4">
                                <!-- Match Type Toggle (Singles/Doubles) -->
                                <div class="flex justify-center mb-6">
                                    <div
                                        class="inline-flex rounded-lg border border-gray-300 bg-gray-50 p-1"
                                    >
                                        <button
                                            type="button"
                                            id="singles-toggle"
                                            class="match-type-toggle active px-6 py-2 rounded-md text-sm font-medium transition-all"
                                        >
                                            <i class="fas fa-user mr-2"></i>Einzel
                                        </button>
                                        <button
                                            type="button"
                                            id="doubles-toggle"
                                            class="match-type-toggle px-6 py-2 rounded-md text-sm font-medium transition-all"
                                        >
                                            <i class="fas fa-users mr-2"></i>Doppel
                                        </button>
                                    </div>
                                </div>

                                <!-- Match Mode Selection -->
                                <div>
                                    <label
                                        for="coach-match-mode-select"
                                        class="block text-sm font-medium text-gray-700 mb-2"
                                    >
                                        Spielmodus
                                    </label>
                                    <select
                                        id="coach-match-mode-select"
                                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white"
                                    >
                                        <option value="single-set">1 Satz</option>
                                        <option value="best-of-3">Best of 3</option>
                                        <option value="best-of-5" selected>
                                            Best of 5 (Standard)
                                        </option>
                                        <option value="best-of-7">Best of 7</option>
                                    </select>
                                </div>

                                <!-- Tennis/Padel Specific Options (hidden for Table Tennis) -->
                                <div id="coach-tennis-options-container" class="hidden space-y-3 mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                                    <h4 class="text-sm font-semibold text-blue-900 mb-2">
                                        <i class="fas fa-tennis-ball mr-2"></i>Tennis/Padel Optionen
                                    </h4>
                                    <div class="flex items-center gap-2">
                                        <input
                                            type="checkbox"
                                            id="coach-golden-point-checkbox"
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                        />
                                        <label for="coach-golden-point-checkbox" class="text-sm text-gray-700">
                                            Golden Point (No-Ad bei 40:40)
                                        </label>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <input
                                            type="checkbox"
                                            id="coach-match-tiebreak-checkbox"
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                        />
                                        <label for="coach-match-tiebreak-checkbox" class="text-sm text-gray-700">
                                            Match Tie-Break statt 3. Satz (bis 10 Punkte)
                                        </label>
                                    </div>
                                </div>

                                <!-- Singles Players (default) -->
                                <div
                                    id="singles-players-container"
                                    class="grid grid-cols-1 md:grid-cols-2 gap-4"
                                >
                                    <div>
                                        <label
                                            for="player-a-select"
                                            class="block text-sm font-medium text-gray-700"
                                            >Spieler A</label
                                        >
                                        <select
                                            id="player-a-select"
                                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                        ></select>
                                    </div>
                                    <div>
                                        <label
                                            for="player-b-select"
                                            class="block text-sm font-medium text-gray-700"
                                            >Spieler B</label
                                        >
                                        <select
                                            id="player-b-select"
                                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                        ></select>
                                    </div>
                                </div>

                                <!-- Doubles Players (hidden by default) -->
                                <div id="doubles-players-container" class="hidden space-y-4">
                                    <div
                                        class="border-2 border-indigo-100 rounded-lg p-4 bg-indigo-50"
                                    >
                                        <h3 class="text-md font-semibold text-indigo-800 mb-3">
                                            <i class="fas fa-user-friends mr-2"></i>Team A
                                        </h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label
                                                    for="doubles-team-a-player1-select"
                                                    class="block text-sm font-medium text-gray-700"
                                                    >Spieler 1</label
                                                >
                                                <select
                                                    id="doubles-team-a-player1-select"
                                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                                ></select>
                                            </div>
                                            <div>
                                                <label
                                                    for="doubles-team-a-player2-select"
                                                    class="block text-sm font-medium text-gray-700"
                                                    >Spieler 2</label
                                                >
                                                <select
                                                    id="doubles-team-a-player2-select"
                                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                                ></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="border-2 border-orange-100 rounded-lg p-4 bg-orange-50"
                                    >
                                        <h3 class="text-md font-semibold text-orange-800 mb-3">
                                            <i class="fas fa-user-friends mr-2"></i>Team B
                                        </h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label
                                                    for="doubles-team-b-player1-select"
                                                    class="block text-sm font-medium text-gray-700"
                                                    >Spieler 1</label
                                                >
                                                <select
                                                    id="doubles-team-b-player1-select"
                                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                                ></select>
                                            </div>
                                            <div>
                                                <label
                                                    for="doubles-team-b-player2-select"
                                                    class="block text-sm font-medium text-gray-700"
                                                    >Spieler 2</label
                                                >
                                                <select
                                                    id="doubles-team-b-player2-select"
                                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                                ></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div
                                    id="handicap-suggestion"
                                    class="p-3 bg-indigo-50 rounded-md text-center hidden"
                                >
                                    <p class="text-sm font-medium text-indigo-800">
                                        Handicap-Vorschlag:
                                        <span id="handicap-text" class="font-bold"></span>
                                    </p>
                                </div>

                                <div id="handicap-toggle-container" class="py-2 hidden">
                                    <label
                                        for="handicap-toggle"
                                        class="flex items-center justify-center cursor-pointer"
                                    >
                                        <div class="relative">
                                            <input
                                                type="checkbox"
                                                id="handicap-toggle"
                                                class="sr-only peer"
                                            />
                                            <div
                                                class="w-14 h-8 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors"
                                            ></div>
                                            <div
                                                class="absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform transform peer-checked:translate-x-full"
                                            ></div>
                                        </div>
                                        <div class="ml-3 text-gray-700 font-medium">
                                            Wurde der Handicap-Vorschlag angewendet?
                                        </div>
                                    </label>
                                </div>

                                <!-- Tournament Match Info -->
                                <div id="coach-tournament-match-info" class="hidden bg-indigo-50 border border-indigo-200 rounded-md p-4">
                                    <p class="text-sm text-indigo-800 font-medium mb-2"><i class="fas fa-trophy"></i> Turnierspiel</p>
                                    <div id="coach-tournament-match-options" class="space-y-2"></div>
                                </div>

                                <!-- Set Score Input Container -->
                                <div>
                                    <label
                                        id="coach-set-score-label"
                                        class="block text-sm font-medium text-gray-700 mb-2"
                                        >Satzergebnisse</label
                                    >
                                    <div id="coach-set-score-container" class="space-y-2"></div>
                                    <p class="text-xs text-gray-500 mt-2">
                                        Der Gewinner wird automatisch aus den Satzergebnissen
                                        ermittelt.
                                    </p>
                                </div>

                                <!-- Match Winner Display -->
                                <div
                                    id="coach-match-winner-info"
                                    class="hidden bg-green-50 border border-green-200 rounded-md p-4"
                                >
                                    <p class="text-sm text-green-800 font-medium mb-1">
                                        <i class="fas fa-trophy"></i> Gewinner
                                    </p>
                                    <p id="coach-match-winner-text" class="text-lg text-green-700 font-bold"></p>
                                </div>

                                <button
                                    type="submit"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                                >
                                    Match-Ergebnis speichern
                                </button>
                                <p
                                    id="match-feedback"
                                    class="mt-3 text-sm font-medium text-center"
                                ></p>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="tab-content-points" class="tab-content hidden">
                    <details class="mb-6 bg-white rounded-xl shadow-md">
                        <summary class="flex justify-between items-center cursor-pointer p-6">
                            <h2 class="text-xl font-semibold text-gray-900">
                                <i class="fas fa-book-open text-indigo-600 mr-3"></i> Regeln &
                                Punktesystem (Anzeigen/Verstecken)
                            </h2>
                            <svg
                                class="h-6 w-6 transform transition-transform"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M19 9l-7 7-7-7"
                                />
                            </svg>
                        </summary>
                        <div class="p-6 border-t border-gray-200 space-y-6">
                            <div>
                                <h2 class="text-xl font-semibold mb-4 border-b pb-2">
                                    Das Punktesystem
                                </h2>
                                <div class="space-y-4">
                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >Was ist der Unterschied zwischen Elo, XP und
                                                Saison-Punkten?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            Es gibt drei Arten von Punkten, die du sammelst:
                                            <ul class="list-disc list-inside mt-2 space-y-2">
                                                <li>
                                                    <strong>‚ö° Skill (Elo):</strong> Dies ist deine
                                                    permanente Spielst√§rke. Du startest mit
                                                    <strong>800 Elo-Punkten</strong>. Du gewinnst
                                                    Elo, indem du Wettkampf-Matches gegen andere
                                                    gewinnst. Du verlierst Elo, wenn du verlierst.
                                                    <strong>Wichtig:</strong> Sobald du bestimmte
                                                    Elo-Meilensteine erreichst (850, 900, 1000,
                                                    1100, 1300, 1600), kannst du nicht mehr darunter
                                                    fallen ‚Äì das sind deine "Sicherheitsnetze". Dein
                                                    Elo-Wert bestimmt ma√ügeblich deinen Rang.
                                                </li>
                                                <li>
                                                    <strong>üí™ Flei√ü (XP):</strong> Das sind deine
                                                    permanenten Erfahrungspunkte. Du erh√§ltst XP f√ºr
                                                    fast alles: Anwesenheit, √úbungen, Challenges und
                                                    Match-Siege.
                                                    <strong>XP werden nie abgezogen</strong> ‚Äì du
                                                    kannst sie nur gewinnen! XP sind (genau wie Elo)
                                                    f√ºr deinen Rangaufstieg n√∂tig. Allerdings k√∂nnen
                                                    Strafen f√ºr unsportliches Verhalten auch XP
                                                    kosten (siehe unten).
                                                </li>
                                                <li>
                                                    <strong>üèÜ Saison-Punkte:</strong> Diese Punkte
                                                    sind nur f√ºr den "Saison-Wettbewerb" (alle 6
                                                    Wochen). Sie werden f√ºr Anwesenheit, √úbungen,
                                                    Challenges und Matches vergeben. Im Gegensatz zu
                                                    XP kannst du Saison-Punkte bei Match-Niederlagen
                                                    oder durch Strafen verlieren. Am Ende der Saison
                                                    werden sie zur√ºckgesetzt.
                                                </li>
                                            </ul>
                                        </div>
                                    </details>
                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >Wie funktionieren die Punkte bei
                                                Einzel-Matches?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                Wenn ein Spieler ein Wettkampf-Match (kein
                                                Handicap-Match) spielt, werden seine
                                                <strong>Elo-Punkte</strong> und
                                                <strong>Saison-Punkte</strong> angepasst. Seine
                                                <strong>XP</strong> k√∂nnen nur steigen.
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>Sieg:</strong> Spieler gewinnt
                                                    Elo-Punkte, Saison-Punkte und XP.
                                                </li>
                                                <li>
                                                    <strong>Niederlage:</strong> Spieler verliert
                                                    Elo-Punkte und Saison-Punkte. Er verliert
                                                    <strong>keine</strong> XP.
                                                </li>
                                                <li>
                                                    <strong>Fairness:</strong> Gewinnt der Spieler
                                                    gegen einen st√§rkeren Gegner (h√∂heres Elo),
                                                    erh√§lt er mehr Punkte. Verliert er gegen einen
                                                    st√§rkeren Gegner, verliert er nur wenige Punkte.
                                                </li>
                                            </ul>
                                            <p class="mt-2">
                                                <strong>Wichtig f√ºr Rekruten:</strong> Als Rekrut
                                                (niedrigster Rang) m√ºssen Spieler erst
                                                <strong>5 Grundlagen-√úbungen</strong> abschlie√üen,
                                                bevor sie Wettkampf-Matches spielen d√ºrfen!
                                            </p>
                                        </div>
                                    </details>

                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >üéæ Wie funktionieren Doppel-Matches?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                Neben Einzel-Matches k√∂nnen Spieler auch
                                                <strong>Doppel-Matches</strong> spielen! Im Doppel
                                                spielen zwei Spieler gemeinsam gegen ein anderes
                                                Team.
                                            </p>

                                            <p class="mt-3"><strong>üìã Der Ablauf:</strong></p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>Team bilden:</strong> Ein Spieler w√§hlt
                                                    einen Partner (Team A) und zwei Gegner (Team B)
                                                </li>
                                                <li>
                                                    <strong>Anfrage senden:</strong> Das Gegner-Team
                                                    muss die Anfrage best√§tigen
                                                </li>
                                                <li>
                                                    <strong>Coach-Genehmigung:</strong> Du musst das
                                                    Match genehmigen und das Ergebnis eintragen
                                                </li>
                                                <li>
                                                    <strong>Punkte:</strong> Alle 4 Spieler erhalten
                                                    oder verlieren Doppel-Elo-Punkte
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>‚ö° Doppel-Elo-System:</strong>
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    Jeder Spieler hat ein
                                                    <strong>separates Doppel-Elo</strong> (startet
                                                    bei 800), unabh√§ngig vom Einzel-Elo
                                                </li>
                                                <li>
                                                    Das Team-Elo wird aus dem Durchschnitt der
                                                    beiden Spieler berechnet
                                                </li>
                                                <li>
                                                    <strong>Beispiel:</strong> Spieler A (Doppel-Elo
                                                    900) + Spieler B (Doppel-Elo 1000) = Team-Elo
                                                    950
                                                </li>
                                                <li>
                                                    Wie beim Einzel gilt: Gewinne gegen st√§rkere
                                                    Teams bringen mehr Punkte
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>üèÜ Doppel-Rangliste:</strong>
                                            </p>
                                            <p class="mt-1">
                                                Es gibt eine eigene Doppel-Rangliste im
                                                <strong>Ranglisten-Tab</strong>, die zeigt, welche
                                                Teams die besten Doppel-Elo-Werte haben!
                                            </p>

                                            <p class="mt-3">
                                                <strong>üìä Punkte-Berechnung:</strong>
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>Sieg:</strong> Beide Spieler des
                                                    Gewinnerteams erhalten Doppel-Elo und
                                                    Saison-Punkte
                                                </li>
                                                <li>
                                                    <strong>Niederlage:</strong> Beide Spieler des
                                                    Verliererteams verlieren Doppel-Elo und
                                                    Saison-Punkte
                                                </li>
                                                <li>
                                                    <strong>XP:</strong> Nur das Gewinnerteam erh√§lt
                                                    XP (kein XP-Verlust bei Niederlage)
                                                </li>
                                                <li>
                                                    <strong>Handicap:</strong> Doppel-Matches k√∂nnen
                                                    auch mit Handicap gespielt werden (keine
                                                    Elo-√Ñnderung)
                                                </li>
                                            </ul>

                                            <p class="mt-3"><strong>üë®‚Äçüè´ F√ºr Coaches:</strong></p>
                                            <ul
                                                class="list-disc list-inside mt-2 space-y-1 bg-indigo-50 p-3 rounded"
                                            >
                                                <li>
                                                    Doppel-Anfragen findest du im
                                                    <strong>Wettkampf-Tab</strong> unter "Doppel"
                                                </li>
                                                <li>
                                                    Du kannst das Ergebnis eintragen und
                                                    entscheiden, ob Handicap verwendet wurde
                                                </li>
                                                <li>
                                                    Du kannst auch selbst Doppel-Matches f√ºr Spieler
                                                    eintragen (z.B. bei offiziellen Turnieren)
                                                </li>
                                                <li>
                                                    Die Doppel-Historie jedes Spielers wird
                                                    automatisch protokolliert
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>üí° Tipp:</strong> Doppel-Matches sind eine
                                                gro√üartige M√∂glichkeit f√ºr Spieler, Teamwork zu
                                                trainieren und neue Spielstile kennenzulernen!
                                            </p>
                                        </div>
                                    </details>
                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >Kann ich auch Punkte verlieren?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            Ja, du kannst Punkte verlieren ‚Äì sogar
                                            <strong>XP</strong>, aber nur bei schweren Verst√∂√üen!
                                            <ul class="list-disc list-inside mt-2 space-y-2">
                                                <li>
                                                    <strong>Match-Niederlage:</strong> Du verlierst
                                                    Elo und Saison-Punkte (siehe oben). Du verlierst
                                                    <strong>keine</strong> XP.
                                                </li>
                                                <li>
                                                    <strong
                                                        >Leichte Verst√∂√üe (z.B. h√∂rt nicht auf
                                                        Anweisungen, hilft nicht beim
                                                        Aufbauen):</strong
                                                    ><br />
                                                    <strong>-10 Saison-Punkte</strong> und
                                                    <strong>-5 XP</strong>
                                                </li>
                                                <li>
                                                    <strong
                                                        >Mittlere Verst√∂√üe (z.B. trainiert nicht
                                                        ordentlich, macht Quatsch, wirft mit
                                                        B√§llen):</strong
                                                    ><br />
                                                    <strong>-20 Saison-Punkte</strong> und
                                                    <strong>-10 XP</strong>
                                                </li>
                                                <li>
                                                    <strong
                                                        >Schwere Verst√∂√üe (z.B. respektloses
                                                        Verhalten gegen√ºber Trainern oder
                                                        Mitspielern):</strong
                                                    ><br />
                                                    <strong>-30 Saison-Punkte</strong> und
                                                    <strong>-20 XP</strong>
                                                </li>
                                            </ul>
                                            <p class="mt-2">
                                                <strong>Wichtig:</strong> Strafen treffen dich
                                                doppelt ‚Äì sie ziehen sowohl Saison-Punkte als auch
                                                XP ab. Also: Fair bleiben und respektvoll
                                                miteinander umgehen!
                                            </p>
                                        </div>
                                    </details>
                                </div>
                            </div>
                            <div>
                                <h2 class="text-xl font-semibold mb-4 border-b pb-2">
                                    Spielmechaniken
                                </h2>
                                <div class="space-y-4">
                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >üìÖ Wie funktioniert das
                                                Anwesenheits-Punktesystem?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700 space-y-3">
                                            <div>
                                                <p class="font-semibold mb-1">
                                                    Punkte pro Training (Saison & XP):
                                                </p>
                                                <ul
                                                    class="list-disc list-inside ml-2 space-y-1 text-sm"
                                                >
                                                    <li>
                                                        <strong>+3 Punkte:</strong> Normale
                                                        Anwesenheit (1-2x Streak)
                                                    </li>
                                                    <li>
                                                        <strong>+5 Punkte:</strong> Streak-Bonus
                                                        (3-4x Streak) ‚ö°
                                                    </li>
                                                    <li>
                                                        <strong>+6 Punkte:</strong> Super-Streak
                                                        (5x+ Streak) üî•
                                                    </li>
                                                </ul>
                                            </div>
                                            <div>
                                                <p class="font-semibold mb-1">
                                                    Mehrfach-Training am selben Tag:
                                                </p>
                                                <ul
                                                    class="list-disc list-inside ml-2 space-y-1 text-sm"
                                                >
                                                    <li>
                                                        <strong>1. Training:</strong> Volle Punkte
                                                        (3/5/6)
                                                    </li>
                                                    <li>
                                                        <strong>2.+ Training:</strong> Halbe Punkte,
                                                        aufgerundet (2/3/3)
                                                    </li>
                                                </ul>
                                                <p class="mt-2 text-sm italic text-gray-600">
                                                    Beispiel: Spieler besucht Basis-Training (16-17
                                                    Uhr) mit 5x Streak = 6 Punkte. Dann
                                                    Leistungs-Training (17-18 Uhr) am selben Tag = 3
                                                    Punkte (halbe Punkte).
                                                </p>
                                            </div>
                                            <div>
                                                <p class="font-semibold mb-1">System-Details:</p>
                                                <ul
                                                    class="list-disc list-inside ml-2 space-y-1 text-sm"
                                                >
                                                    <li>
                                                        Datum wird in Historie angezeigt: "Training
                                                        am DD.MM.YYYY - Untergruppe"
                                                    </li>
                                                    <li>
                                                        2. Training wird markiert: "(2. Training
                                                        heute)"
                                                    </li>
                                                    <li>
                                                        Streak-Bonus wird angezeigt: "(‚ö° 3x
                                                        Streak)" oder "(üî• 5x Streak!)"
                                                    </li>
                                                    <li>
                                                        Bei abgesagtem Training werden Punkte
                                                        automatisch korrigiert
                                                    </li>
                                                </ul>
                                            </div>
                                            <p class="mt-2">
                                                <strong>‚ö†Ô∏è Wichtig:</strong> Wenn ein Training
                                                verpasst wird, wird der Streak auf Null
                                                zur√ºckgesetzt. Regelm√§√üiges Training lohnt sich!
                                            </p>
                                        </div>
                                    </details>

                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >Wie funktionieren √úbungen und Punkte?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                √úbungen sind in
                                                <strong>drei Schwierigkeitsstufen</strong>
                                                eingeteilt: Leicht, Mittel und Schwer. Die Punkte,
                                                die du erh√§ltst, h√§ngen sowohl von der Schwierigkeit
                                                der √úbung als auch von deinem aktuellen Level ab:
                                            </p>

                                            <div class="mt-2 overflow-x-auto">
                                                <table
                                                    class="min-w-full border border-gray-300 text-sm"
                                                >
                                                    <thead class="bg-gray-100">
                                                        <tr>
                                                            <th
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Dein Level
                                                            </th>
                                                            <th
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Leichte √úbung
                                                            </th>
                                                            <th
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Mittlere √úbung
                                                            </th>
                                                            <th
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Schwere √úbung
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Rekrut/Bronze
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                5 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                8 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                10 P.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Silber/Gold
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                6 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                10 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                12 P.
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1"
                                                            >
                                                                Platin/Champion
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                8 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                12 P.
                                                            </td>
                                                            <td
                                                                class="border border-gray-300 px-2 py-1 text-center"
                                                            >
                                                                18 P.
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <p class="mt-2">
                                                <strong>Wichtig:</strong> Je h√∂her dein Level, desto
                                                mehr Punkte bekommst du f√ºr dieselbe √úbung. Das
                                                System berechnet die Punkte automatisch basierend
                                                auf deinem aktuellen Rang und der
                                                √úbungsschwierigkeit.
                                            </p>
                                            <p class="mt-2">
                                                Du erh√§ltst sowohl
                                                <strong>Saison-Punkte</strong> als auch
                                                <strong>XP</strong> in gleicher H√∂he.
                                            </p>
                                        </div>
                                    </details>

                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >‚ú® Was sind Meilenstein-√úbungen und
                                                -Challenges?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                Manche √úbungen und Challenges verwenden ein
                                                <strong>abgestuftes Punktesystem</strong> mit
                                                Meilensteinen. Das bedeutet: Je √∂fter ein Spieler
                                                eine √úbung schafft, desto mehr Punkte kann er
                                                insgesamt verdienen!
                                            </p>

                                            <p class="mt-3">
                                                <strong>üìä Beispiel: Endlos-Aufschlag-√úbung</strong>
                                            </p>
                                            <ul
                                                class="list-disc list-inside mt-2 space-y-1 bg-indigo-50 p-3 rounded"
                                            >
                                                <li>1√ó geschafft ‚Üí <strong>3 Punkte</strong></li>
                                                <li>
                                                    3√ó geschafft ‚Üí
                                                    <strong>+5 Punkte</strong> (insgesamt 8 Punkte)
                                                </li>
                                                <li>
                                                    5√ó geschafft ‚Üí
                                                    <strong>+8 Punkte</strong> (insgesamt 16 Punkte)
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>üéØ So vergibst du Punkte als Coach:</strong>
                                            </p>
                                            <ul
                                                class="list-disc list-inside mt-2 space-y-1 bg-gray-50 p-3 rounded"
                                            >
                                                <li>
                                                    Bei Meilenstein-√úbungen w√§hlst du aus,
                                                    <strong>welchen Meilenstein</strong> der Spieler
                                                    erreicht hat (z.B. "3√ó" oder "5√ó")
                                                </li>
                                                <li>
                                                    Das System zeigt automatisch an:
                                                    <ul
                                                        class="list-circle list-inside ml-6 mt-1 space-y-1 text-sm"
                                                    >
                                                        <li>
                                                            Welche Meilensteine bereits erreicht
                                                            wurden ‚úì
                                                        </li>
                                                        <li>
                                                            Welche Punkte f√ºr den n√§chsten
                                                            Meilenstein vergeben werden
                                                        </li>
                                                        <li>
                                                            Die Gesamt-Anzahl an Wiederholungen des
                                                            Spielers
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li>
                                                    Ein Spieler kann
                                                    <strong
                                                        >nicht zweimal denselben Meilenstein</strong
                                                    >
                                                    bekommen ‚Äì wenn er 5√ó bereits hat, kann er nicht
                                                    nochmal 3√ó bekommen
                                                </li>
                                                <li>
                                                    Ein Spieler kann aber
                                                    <strong>mehrere Meilensteine auf einmal</strong>
                                                    √ºberspringen ‚Äì direkt von 1√ó auf 5√ó ist m√∂glich!
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>üí° Tipp beim Erstellen:</strong> Beim
                                                Erstellen einer √úbung oder Challenge kannst du
                                                zwischen normalem Punktesystem und Meilensteinen
                                                w√§hlen. Meilensteine eignen sich besonders f√ºr:
                                            </p>
                                            <ul
                                                class="list-disc list-inside ml-6 mt-1 space-y-1 text-sm"
                                            >
                                                <li>
                                                    Endlos-√úbungen (z.B. "100 Aufschl√§ge in Folge")
                                                </li>
                                                <li>
                                                    Wiederholbare Challenges (z.B. "Topspin-Serie")
                                                </li>
                                                <li>
                                                    Langzeit-Ziele mit steigendem Schwierigkeitsgrad
                                                </li>
                                            </ul>
                                        </div>
                                    </details>

                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >üîÑ Wie funktioniert der Saison-Reset?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                Jede <strong>6 Wochen</strong> (42 Tage) wird eine
                                                neue Saison gestartet. Der Reset erfolgt
                                                <strong>automatisch um Mitternacht</strong>.
                                            </p>

                                            <p class="mt-3">
                                                <strong>Was wird zur√ºckgesetzt?</strong>
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>Saison-Punkte:</strong> Werden auf 0
                                                    zur√ºckgesetzt
                                                </li>
                                                <li>
                                                    <strong>Liga-Platzierungen:</strong> Top 2 jeder
                                                    Liga steigen auf, Bottom 2 steigen ab
                                                </li>
                                                <li>
                                                    <strong>Meilenstein-Fortschritt:</strong> Alle
                                                    Meilensteine k√∂nnen erneut erreicht werden
                                                </li>
                                                <li>
                                                    <strong>Abschluss-Status:</strong> √úbungen und
                                                    Challenges k√∂nnen erneut absolviert werden
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>Was bleibt erhalten?</strong>
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>Einzel-Elo:</strong> Die
                                                    Einzel-Skill-Bewertung bleibt permanent
                                                </li>
                                                <li>
                                                    <strong>Doppel-Elo:</strong> Die
                                                    Doppel-Skill-Bewertung bleibt permanent
                                                </li>
                                                <li>
                                                    <strong>XP (Erfahrungspunkte):</strong> Der
                                                    Flei√ü wird nie zur√ºckgesetzt
                                                </li>
                                                <li>
                                                    <strong>Rang:</strong> Der Rang (Rekrut, Bronze,
                                                    Silber...) ist permanent
                                                </li>
                                                <li>
                                                    <strong>Grundlagen-Abschl√ºsse:</strong> Die 5
                                                    Grundlagen-√úbungen bleiben abgeschlossen
                                                </li>
                                            </ul>

                                            <p class="mt-3">
                                                <strong>üí° Tipp:</strong> Das Dashboard zeigt einen
                                                Countdown bis zum n√§chsten Saison-Reset. Das
                                                motiviert Spieler, noch schnell Punkte zu sammeln!
                                            </p>
                                        </div>
                                    </details>

                                    <details class="group">
                                        <summary
                                            class="flex justify-between items-center cursor-pointer"
                                        >
                                            <span class="font-medium"
                                                >Wie funktionieren die R√§nge und das
                                                Leaderboard?</span
                                            >
                                            <svg
                                                class="h-6 w-6 transform transition-transform group-open:rotate-180"
                                                fill="none"
                                                viewBox="0 0 24 24"
                                                stroke="currentColor"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                />
                                            </svg>
                                        </summary>
                                        <div class="mt-2 text-gray-700">
                                            <p>
                                                Dein Rang (z.B. Rekrut, Bronze, Silber) ist
                                                <strong>permanent</strong> und wird nie
                                                zur√ºckgesetzt. Um im Rang aufzusteigen, musst du
                                                bestimmte Meilensteine bei
                                                <strong>Elo (Skill)</strong> und
                                                <strong>XP (Flei√ü)</strong> erreichen.
                                            </p>

                                            <p class="mt-2">
                                                <strong>Die R√§nge und ihre Anforderungen:</strong>
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-2">
                                                <li>
                                                    <strong>ü•â Rekrut (Start):</strong> 0-49 XP,
                                                    800-849 Elo, 0 Grundlagen<br />
                                                    <em>Du startest hier mit 800 Elo und 0 XP.</em>
                                                </li>
                                                <li>
                                                    <strong>ü•â Bronze:</strong> 50+ XP, 850+ Elo, 5
                                                    Grundlagen<br />
                                                    <em
                                                        >Lerne erst die Basics, bevor du Matches
                                                        spielen darfst!</em
                                                    >
                                                </li>
                                                <li>
                                                    <strong>ü•à Silber:</strong> 200+ XP, 900+ Elo
                                                </li>
                                                <li>
                                                    <strong>ü•á Gold:</strong> 500+ XP, 1000+ Elo
                                                </li>
                                                <li>
                                                    <strong>üíé Platin:</strong> 1000+ XP, 1100+ Elo
                                                </li>
                                                <li>
                                                    <strong>üëë Champion:</strong> 1800+ XP, 1300+
                                                    Elo<br />
                                                    <em
                                                        >Die Elite ‚Äì nur die Besten schaffen es
                                                        hierher!</em
                                                    >
                                                </li>
                                            </ul>

                                            <p class="mt-2">
                                                <strong>Wichtig:</strong> Du musst immer
                                                <strong>beide</strong> Anforderungen (Elo UND XP)
                                                f√ºr den n√§chsten Rang erf√ºllen. F√ºr Bronze musst du
                                                zus√§tzlich 5 Grundlagen-√úbungen abschlie√üen.
                                            </p>

                                            <p class="mt-2">
                                                <strong
                                                    >Das Leaderboard (Ranglisten) ist in mehrere
                                                    Tabs aufgeteilt:</strong
                                                >
                                            </p>
                                            <ul class="list-disc list-inside mt-2 space-y-1">
                                                <li>
                                                    <strong>üí™ Flei√ü (XP):</strong> Zeigt die
                                                    Rangliste basierend auf Erfahrungspunkten.
                                                </li>
                                                <li>
                                                    <strong>‚≠ê Season (Punkte):</strong> Zeigt die
                                                    aktuelle Saison-Rangliste.
                                                </li>
                                                <li>
                                                    <strong>‚ö° Skill (Elo):</strong> Zeigt die
                                                    Rangliste basierend auf Einzel-Elo-Punkten.
                                                </li>
                                                <li>
                                                    <strong>üèÜ R√§nge (Level):</strong> Zeigt alle
                                                    Spieler gruppiert nach ihrem aktuellen Rang
                                                    (z.B. alle in Bronze, alle in Silber).
                                                </li>
                                                <li>
                                                    <strong>üéæ Doppel (Teams):</strong> Zeigt die
                                                    Doppel-Rangliste mit den besten
                                                    Team-Kombinationen basierend auf Doppel-Elo.
                                                </li>
                                            </ul>
                                            <p class="mt-2 text-sm italic text-gray-600">
                                                Spieler k√∂nnen im Ranglisten-Tab einstellen, welche
                                                Ranglisten sie sehen m√∂chten.
                                            </p>
                                        </div>
                                    </details>
                                </div>
                            </div>
                        </div>
                    </details>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-semibold mb-4">Punkte vergeben</h2>
                            <form id="points-form" class="space-y-4">
                                <div>
                                    <label
                                        for="player-select"
                                        class="block text-sm font-medium text-gray-700"
                                        >Spieler ausw√§hlen</label
                                    >
                                    <select
                                        id="player-select"
                                        required
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="">Spieler w√§hlen...</option>
                                    </select>
                                </div>
                                <div
                                    id="coach-grundlagen-info"
                                    class="hidden p-3 bg-blue-50 border border-blue-200 rounded-lg"
                                >
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0">
                                            <svg
                                                class="h-5 w-5 text-blue-400"
                                                fill="currentColor"
                                                viewBox="0 0 20 20"
                                            >
                                                <path
                                                    fill-rule="evenodd"
                                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                                    clip-rule="evenodd"
                                                />
                                            </svg>
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <p class="text-sm font-medium text-blue-800">
                                                üìö Grundlagen-Status
                                            </p>
                                            <p
                                                id="coach-grundlagen-text"
                                                class="mt-1 text-sm text-blue-700"
                                            ></p>
                                            <div class="mt-2 w-full bg-blue-200 rounded-full h-2">
                                                <div
                                                    id="coach-grundlagen-bar"
                                                    class="bg-blue-600 h-2 rounded-full transition-all"
                                                    style="width: 0%"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <label
                                        for="reason-select"
                                        class="block text-sm font-medium text-gray-700"
                                        >Grund</label
                                    >
                                    <select
                                        id="reason-select"
                                        required
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="">Grund w√§hlen...</option>
                                        <option value="exercise">√úbung abgeschlossen</option>
                                        <option value="challenge">Challenge gemeistert</option>
                                        <option value="manual">Manuelle Vergabe</option>
                                    </select>
                                </div>
                                <div id="exercise-select-container" class="hidden">
                                    <label
                                        for="exercise-select"
                                        class="block text-sm font-medium text-gray-700"
                                        >√úbung ausw√§hlen</label
                                    >
                                    <select
                                        id="exercise-select"
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    ></select>
                                </div>
                                <div id="challenge-select-container" class="hidden">
                                    <label
                                        for="challenge-select"
                                        class="block text-sm font-medium text-gray-700"
                                        >Challenge ausw√§hlen</label
                                    >
                                    <select
                                        id="challenge-select"
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    ></select>
                                </div>
                                <!-- Milestone Count Input (shown when exercise/challenge has milestones) -->
                                <div
                                    id="milestone-select-container"
                                    class="hidden bg-indigo-50 border border-indigo-200 rounded-lg p-4"
                                >
                                    <label
                                        for="milestone-count-input"
                                        class="block text-sm font-medium text-indigo-900 mb-2"
                                        >üéØ Wie viele Wiederholungen wurden geschafft?</label
                                    >
                                    <input
                                        type="number"
                                        id="milestone-count-input"
                                        min="1"
                                        placeholder="z.B. 10"
                                        class="mt-1 block w-full pl-3 pr-3 py-2 text-base border-indigo-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    />
                                    <div
                                        id="milestone-info"
                                        class="mt-3 text-xs text-indigo-700 bg-white p-2 rounded"
                                    >
                                        <div class="flex justify-between">
                                            <span
                                                ><strong>Erreichte Meilensteine:</strong>
                                                <span id="milestone-progress-text">-</span></span
                                            >
                                            <span
                                                ><strong>Punkte:</strong>
                                                <span
                                                    id="milestone-points-text"
                                                    class="font-bold text-indigo-600"
                                                    >0 P.</span
                                                ></span
                                            >
                                        </div>
                                    </div>
                                </div>
                                <!-- Partner Selection (shown when exercise/challenge has partner system enabled) -->
                                <div
                                    id="partner-select-container"
                                    class="hidden bg-green-50 border border-green-200 rounded-lg p-4"
                                >
                                    <label
                                        for="partner-select"
                                        class="block text-sm font-medium text-green-900 mb-2"
                                        >üë• Trainingspartner ausw√§hlen (optional)</label
                                    >
                                    <select
                                        id="partner-select"
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-green-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md bg-white"
                                    >
                                        <option value="">
                                            Kein Partner (Spieler trainiert alleine oder mit
                                            Trainer)
                                        </option>
                                    </select>
                                    <div
                                        id="partner-info"
                                        class="mt-3 text-xs text-green-700 bg-white p-3 rounded border border-green-200"
                                    >
                                        <div class="space-y-2">
                                            <div class="flex items-start gap-2">
                                                <span class="text-base">üí™</span>
                                                <div class="flex-1">
                                                    <strong>Aktiver Spieler:</strong>
                                                    <span
                                                        id="active-player-name"
                                                        class="font-semibold"
                                                        >-</span
                                                    >
                                                    <div class="text-green-600 font-medium">
                                                        Erh√§lt 100% der Punkte & XP +
                                                        Meilenstein-Fortschritt
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex items-start gap-2">
                                                <span class="text-base">ü§ù</span>
                                                <div class="flex-1">
                                                    <strong>Passiver Spieler (Partner):</strong>
                                                    <span
                                                        id="passive-player-name"
                                                        class="font-semibold"
                                                        >-</span
                                                    >
                                                    <div
                                                        id="partner-reward-info"
                                                        class="text-green-600 font-medium"
                                                    >
                                                        Erh√§lt
                                                        <span id="partner-percentage">50</span>% der
                                                        Punkte & XP
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Completion Status (shown when exercise/challenge without milestones is selected) -->
                                <div
                                    id="completion-status-container"
                                    class="hidden bg-blue-50 border border-blue-200 rounded-lg p-4"
                                >
                                    <div class="text-sm text-blue-900">
                                        <div id="completion-status-text" class="space-y-2">
                                            <!-- Will be populated dynamically -->
                                        </div>
                                    </div>
                                </div>
                                <div id="manual-points-container" class="hidden space-y-4">
                                    <div>
                                        <label
                                            for="manual-points"
                                            class="block text-sm font-medium text-gray-700"
                                            >Anzahl Punkte</label
                                        >
                                        <input
                                            type="number"
                                            id="manual-points"
                                            placeholder="z.B. 10 oder -5"
                                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                        />
                                    </div>
                                    <div>
                                        <label
                                            for="manual-reason"
                                            class="block text-sm font-medium text-gray-700"
                                            >Begr√ºndung</label
                                        >
                                        <input
                                            type="text"
                                            id="manual-reason"
                                            placeholder="z.B. Faires Spiel"
                                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                        />
                                    </div>

                                    <!-- Manual Partner Selection -->
                                    <div class="border-t pt-3">
                                        <div class="flex items-center mb-2">
                                            <input
                                                type="checkbox"
                                                id="manual-partner-toggle"
                                                class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                                            />
                                            <label
                                                for="manual-partner-toggle"
                                                class="ml-2 text-sm font-medium text-gray-700"
                                            >
                                                üë• Mit Trainingspartner
                                            </label>
                                        </div>
                                        <div id="manual-partner-container" class="hidden">
                                            <label
                                                for="manual-partner-select"
                                                class="block text-sm font-medium text-gray-700 mb-1"
                                                >Trainingspartner (optional)</label
                                            >
                                            <select
                                                id="manual-partner-select"
                                                class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md bg-white mb-2"
                                            >
                                                <option value="">Kein Partner</option>
                                            </select>
                                            <label
                                                for="manual-partner-percentage"
                                                class="block text-sm font-medium text-gray-700 mb-1"
                                                >Prozentsatz f√ºr Partner</label
                                            >
                                            <div class="flex items-center gap-2">
                                                <input
                                                    type="number"
                                                    id="manual-partner-percentage"
                                                    min="0"
                                                    max="100"
                                                    value="50"
                                                    class="w-20 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                                />
                                                <span class="text-sm text-gray-600"
                                                    >% der Punkte & XP</span
                                                >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button
                                    type="submit"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                                >
                                    Punkte speichern
                                </button>
                                <p
                                    id="points-feedback"
                                    class="mt-3 text-sm font-medium text-center"
                                ></p>
                            </form>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-semibold mb-4">Punkte-Historie</h2>
                            <div>
                                <label
                                    for="history-player-filter"
                                    class="block text-sm font-medium text-gray-700"
                                    >Spieler filtern</label
                                >
                                <select
                                    id="history-player-filter"
                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                >
                                    <option value="">Bitte Spieler w√§hlen...</option>
                                </select>
                            </div>
                            <ul
                                id="coach-points-history-list"
                                class="mt-4 space-y-3 max-h-96 overflow-y-auto"
                            >
                                <li class="text-center text-gray-500 py-4">
                                    Bitte einen Spieler ausw√§hlen, um die Historie anzuzeigen.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="tab-content-challenges" class="tab-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-semibold mb-4">Neue Challenge erstellen</h2>
                            <form id="create-challenge-form" class="space-y-4">
                                <div>
                                    <label
                                        for="challenge-title"
                                        class="block text-sm font-medium text-gray-700"
                                        >Titel</label
                                    >
                                    <input
                                        type="text"
                                        id="challenge-title"
                                        required
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                    />
                                </div>
                                <div>
                                    <label
                                        for="challenge-type"
                                        class="block text-sm font-medium text-gray-700"
                                        >Typ (Dauer)</label
                                    >
                                    <select
                                        id="challenge-type"
                                        required
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="daily">1 Tag</option>
                                        <option value="weekly">1 Woche</option>
                                        <option value="monthly">1 Monat</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        for="challenge-description"
                                        class="block text-sm font-medium text-gray-700"
                                        >Beschreibung</label
                                    >
                                    <textarea
                                        id="challenge-description"
                                        rows="3"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                    ></textarea>
                                </div>
                                <!-- Einheit f√ºr Meilensteine -->
                                <div>
                                    <label
                                        for="challenge-unit"
                                        class="block text-sm font-medium text-gray-700"
                                        >Einheit</label
                                    >
                                    <select
                                        id="challenge-unit"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                    >
                                        <option value="Wiederholungen">Wiederholungen</option>
                                        <option value="Sterne">Sterne</option>
                                        <option value="Punkte">Punkte</option>
                                        <option value="Treffer">Treffer</option>
                                        <option value="Sekunden">Sekunden</option>
                                        <option value="Minuten">Minuten</option>
                                        <option value="Runden">Runden</option>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">
                                        Die Einheit f√ºr Meilensteine (z.B. "7 Sterne" statt "7 Wiederholungen")
                                    </p>
                                </div>
                                <!-- Points System Toggle -->
                                <div class="border-t border-gray-200 pt-4">
                                    <label class="flex items-center cursor-pointer">
                                        <input
                                            type="checkbox"
                                            id="challenge-milestones-enabled"
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                        />
                                        <span class="ml-2 text-sm font-medium text-gray-700"
                                            >Abgestufte Punktevergabe (Meilensteine)</span
                                        >
                                    </label>
                                    <p class="text-xs text-gray-500 mt-1 ml-6">
                                        Z.B. 1√ó erreicht = 3 Punkte, 3√ó erreicht = +5 Punkte
                                        zus√§tzlich
                                    </p>
                                </div>

                                <!-- Standard Points -->
                                <div id="challenge-standard-points-container">
                                    <label
                                        for="challenge-points"
                                        class="block text-sm font-medium text-gray-700"
                                        >Punkte</label
                                    >
                                    <input
                                        type="number"
                                        id="challenge-points"
                                        required
                                        min="1"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                    />
                                    <p
                                        id="challenge-points-hint"
                                        class="mt-1 text-xs text-gray-600"
                                    >
                                        üí° <strong>Empfehlung:</strong>
                                        <span id="challenge-points-range">8-20 Punkte</span> f√ºr
                                        <span id="challenge-duration-text">t√§gliche</span>
                                        Challenges
                                    </p>
                                </div>

                                <!-- Milestone Points -->
                                <div id="challenge-milestones-container" class="hidden space-y-3">
                                    <label class="block text-sm font-medium text-gray-700"
                                        >Meilensteine definieren</label
                                    >
                                    <div id="challenge-milestones-list" class="space-y-2">
                                        <!-- Milestone entries will be added here dynamically -->
                                    </div>
                                    <button
                                        type="button"
                                        id="add-challenge-milestone-btn"
                                        class="text-sm text-indigo-600 hover:text-indigo-800 font-medium"
                                    >
                                        + Meilenstein hinzuf√ºgen
                                    </button>
                                    <div class="text-xs text-gray-600 bg-gray-50 p-2 rounded">
                                        <strong>Max. erreichbare Punkte:</strong>
                                        <span
                                            id="challenge-total-milestone-points"
                                            class="font-bold text-indigo-600"
                                            >0</span
                                        >
                                        P.
                                    </div>
                                </div>
                                <div>
                                    <label
                                        for="challenge-subgroup"
                                        class="block text-sm font-medium text-gray-700"
                                        >Untergruppe</label
                                    >
                                    <select
                                        id="challenge-subgroup"
                                        required
                                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="all">Alle (Gesamtverein)</option>
                                        <!-- Subgroups will be loaded dynamically -->
                                    </select>
                                </div>
                                <div class="flex items-center">
                                    <input
                                        type="checkbox"
                                        id="challenge-repeatable"
                                        class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                                    />
                                    <label
                                        for="challenge-repeatable"
                                        class="ml-2 block text-sm text-gray-700"
                                    >
                                        Mehrfach einl√∂sbar
                                        <span class="text-gray-500"
                                            >(z.B. f√ºr "Besiegter Spieler")</span
                                        >
                                    </label>
                                </div>

                                <!-- Partner System -->
                                <div class="border-t pt-4">
                                    <div class="flex items-center mb-3">
                                        <input
                                            type="checkbox"
                                            id="challenge-partner-system-toggle-coach"
                                            class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                                        />
                                        <label
                                            for="challenge-partner-system-toggle-coach"
                                            class="ml-2 text-sm font-medium text-gray-700"
                                        >
                                            üë• Partner-System aktivieren (Challenge mit
                                            Trainingspartner)
                                        </label>
                                    </div>
                                    <div
                                        id="challenge-partner-container-coach"
                                        class="hidden space-y-3 bg-green-50 p-4 rounded-lg"
                                    >
                                        <p class="text-xs text-green-700 mb-3">
                                            <strong>Partner-System:</strong> Bei dieser Challenge
                                            trainieren zwei Spieler zusammen. Der passive Spieler
                                            (z.B. Zuspieler/Blocker) erh√§lt einen Prozentsatz der
                                            Punkte des aktiven Spielers.
                                        </p>
                                        <div>
                                            <label
                                                for="challenge-partner-percentage-coach"
                                                class="block text-sm font-medium text-gray-700"
                                            >
                                                Prozentsatz f√ºr passiven Spieler
                                            </label>
                                            <div class="flex items-center gap-3 mt-2">
                                                <input
                                                    type="number"
                                                    id="challenge-partner-percentage-coach"
                                                    min="0"
                                                    max="100"
                                                    value="50"
                                                    class="w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                                />
                                                <span class="text-sm text-gray-600"
                                                    >% der Punkte & XP</span
                                                >
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">
                                                Standard: 50% (Zuspieler/Blocker). Bei 100% erhalten
                                                beide Spieler die gleichen Punkte.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <button
                                    type="submit"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                                >
                                    Challenge erstellen
                                </button>
                                <p
                                    id="challenge-feedback"
                                    class="mt-3 text-sm font-medium text-center"
                                ></p>
                            </form>
                        </div>
                        <div class="lg:col-span-2 space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-md">
                                <h2 class="text-xl font-semibold mb-4">
                                    Aktive Challenges im Verein
                                </h2>
                                <div id="active-challenges-list" class="space-y-4">
                                    <p class="text-gray-500">Aktive Challenges werden geladen...</p>
                                </div>
                            </div>

                            <div class="bg-white p-6 rounded-xl shadow-md">
                                <h2 class="text-xl font-semibold mb-4">Abgelaufene Challenges</h2>
                                <div id="expired-challenges-list" class="space-y-4">
                                    <p class="text-gray-500">
                                        Abgelaufene Challenges werden geladen...
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-content-exercises" class="tab-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md">
                            <!-- Info Box for Coaches -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-start gap-3">
                                    <div class="flex-shrink-0">
                                        <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-sm font-semibold text-blue-800 mb-1">Hinweis</h3>
                                        <p class="text-sm text-blue-700">
                                            Neue √úbungen werden vom Administrator erstellt und verwaltet.
                                            Du kannst hier alle verf√ºgbaren √úbungen einsehen und f√ºr dein Training nutzen.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="lg:col-span-2 bg-white p-4 sm:p-6 rounded-xl shadow-md">
                            <!-- Header mit Suche und Filter -->
                            <div class="flex flex-col sm:flex-row sm:items-center gap-3 mb-4">
                                <button
                                    id="toggle-tags-filter-coach"
                                    class="flex items-center gap-2 text-gray-600 hover:text-indigo-600 font-medium text-sm px-3 py-2 border border-gray-300 rounded-lg hover:border-indigo-400 transition-colors"
                                >
                                    <i class="fas fa-filter"></i>
                                    <span>Filter</span>
                                </button>
                                <div class="flex-1">
                                    <div class="relative">
                                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                        <input
                                            type="text"
                                            id="exercise-search-input-coach"
                                            placeholder="Suche nach √úbungen"
                                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                        />
                                    </div>
                                </div>
                            </div>
                            <!-- Tag Filter Section (Collapsible) -->
                            <div
                                id="tags-filter-section-coach"
                                class="hidden border border-gray-200 rounded-lg p-3 bg-gray-50 mb-4"
                            >
                                <input
                                    type="text"
                                    id="tag-search-coach"
                                    placeholder="Tag suchen..."
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm mb-3 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                />
                                <div
                                    id="tags-filter-container-coach"
                                    class="flex flex-wrap gap-2 max-h-32 overflow-y-auto"
                                >
                                    <!-- Tag buttons will be dynamically inserted here -->
                                </div>
                            </div>
                            <!-- √úbungsliste -->
                            <div
                                id="exercises-list-coach"
                                class="flex flex-col divide-y divide-gray-200 border border-gray-200 rounded-lg overflow-hidden max-h-[70vh] overflow-y-auto"
                            >
                                <p class="p-4 text-gray-500">√úbungen werden geladen...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-content-statistics" class="tab-content hidden">
                    <div class="space-y-8">
                        <!-- Season Countdown - Klickbar f√ºr Head-Coach -->
                        <div
                            id="season-banner-coach"
                            class="bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300 p-4 rounded-xl shadow-md cursor-pointer hover:shadow-lg transition-shadow"
                            onclick="window.openSeasonModalCoach && window.openSeasonModalCoach()"
                        >
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="bg-yellow-400 p-3 rounded-full">
                                        <svg
                                            class="w-6 h-6 text-yellow-900"
                                            fill="none"
                                            stroke="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="2"
                                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                                            ></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-sm font-semibold text-yellow-900">
                                            ‚è≥ Saison-Ende
                                        </h3>
                                        <p class="text-xs text-yellow-700">
                                            Klicken f√ºr Saison-Verwaltung (nur Head-Coach)
                                        </p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p
                                        id="season-countdown-coach"
                                        class="text-2xl font-bold text-yellow-900"
                                    >
                                        Saisonpause
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Veranstaltungen mit Tagesnavigation -->
                        <div class="bg-white rounded-xl shadow-md p-6">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4">
                                <h3 class="text-lg font-bold text-gray-900 flex items-center">
                                    <svg class="w-6 h-6 text-indigo-600 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                    </svg>
                                    Veranstaltungen
                                </h3>
                                <div class="flex items-center gap-2 justify-center sm:justify-end">
                                    <button id="events-prev-day" class="p-1.5 rounded-full hover:bg-gray-100 text-gray-500 hover:text-indigo-600 transition-colors" title="Vorheriger Tag">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                        </svg>
                                    </button>
                                    <span class="text-sm text-gray-600 font-medium text-center whitespace-nowrap" id="events-date-display"></span>
                                    <button id="events-next-day" class="p-1.5 rounded-full hover:bg-gray-100 text-gray-500 hover:text-indigo-600 transition-colors" title="N√§chster Tag">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div id="events-day-list" class="space-y-3">
                                <div class="flex items-center justify-center py-8 text-gray-400">
                                    <svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Lade Veranstaltungen...
                                </div>
                            </div>
                        </div>

                        <!-- Club Join/Leave Requests Section -->
                        <div class="space-y-6">
                            <!-- Beitrittsanfragen -->
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                    <i class="fas fa-user-plus text-indigo-600 mr-2"></i>
                                    Ausstehende Beitrittsanfragen
                                </h3>
                                <div id="club-join-requests-list">
                                    <!-- Wird dynamisch von club-requests-manager.js gef√ºllt -->
                                    <p class="text-gray-500 text-sm text-center py-4">Lade Anfragen...</p>
                                </div>
                            </div>

                            <!-- Austrittsanfragen -->
                            <div class="bg-white rounded-lg shadow-md p-6">
                                <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                    <i class="fas fa-sign-out-alt text-orange-600 mr-2"></i>
                                    Ausstehende Austrittsanfragen
                                </h3>
                                <div id="leave-requests-list">
                                    <!-- Wird dynamisch von club-requests-manager.js gef√ºllt -->
                                    <p class="text-gray-500 text-sm text-center py-4">Lade Anfragen...</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-2xl font-bold mb-6 flex items-center">
                                <span class="mr-3">üìà</span> Trainingsanwesenheiten
                            </h2>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                                <div class="bg-indigo-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Diese Woche</p>
                                    <p
                                        id="stats-attendance-week"
                                        class="text-3xl font-bold text-indigo-600"
                                    >
                                        -
                                    </p>
                                    <p class="text-xs text-gray-500 mt-1">√ò Teilnehmer</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Dieser Monat</p>
                                    <p
                                        id="stats-attendance-month"
                                        class="text-3xl font-bold text-blue-600"
                                    >
                                        -
                                    </p>
                                    <p class="text-xs text-gray-500 mt-1">√ò Teilnehmer</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Gesamt Trainingstage</p>
                                    <p
                                        id="stats-total-trainings"
                                        class="text-3xl font-bold text-purple-600"
                                    >
                                        -
                                    </p>
                                    <p class="text-xs text-gray-500 mt-1">Diese Saison</p>
                                </div>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="text-lg font-semibold mb-4">Trend (Letzte 12 Wochen)</h3>
                                <canvas id="attendance-trend-chart" height="80"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-2xl font-bold mb-6 flex items-center">
                                <span class="mr-3">üë•</span> Team-√úbersicht
                            </h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                                <div class="bg-green-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Team-Gr√∂√üe</p>
                                    <p
                                        id="stats-team-size"
                                        class="text-3xl font-bold text-green-600"
                                    >
                                        -
                                    </p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">√ò Alter</p>
                                    <p
                                        id="stats-avg-age"
                                        class="text-3xl font-bold text-yellow-600"
                                    >
                                        -
                                    </p>
                                </div>
                                <div class="bg-pink-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">√ò Elo</p>
                                    <p id="stats-avg-elo" class="text-3xl font-bold text-pink-600">
                                        -
                                    </p>
                                </div>
                                <div class="bg-cyan-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">√ò XP</p>
                                    <p id="stats-avg-xp" class="text-3xl font-bold text-cyan-600">
                                        -
                                    </p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold mb-4 text-center">
                                        Altersverteilung
                                    </h3>
                                    <canvas id="age-distribution-chart"></canvas>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold mb-4 text-center">
                                        Geschlechterverteilung
                                    </h3>
                                    <canvas id="gender-distribution-chart"></canvas>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold mb-4 text-center">
                                        Level-Verteilung
                                    </h3>
                                    <canvas id="rank-distribution-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-2xl font-bold mb-6 flex items-center">
                                <span class="mr-3">üî•</span> Aktivit√§ts-Monitor
                            </h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                                        üèÜ Top Streak
                                    </h3>
                                    <ul id="stats-top-streaks" class="space-y-2">
                                        <li class="text-gray-500">Lade Daten...</li>
                                    </ul>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                                        ‚ö†Ô∏è Gef√§hrdete Spieler
                                    </h3>
                                    <p class="text-xs text-gray-500 mb-3">
                                        Nicht beim Training seit &gt;2 Wochen
                                    </p>
                                    <ul id="stats-inactive-players" class="space-y-2">
                                        <li class="text-gray-500">Lade Daten...</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                                <div class="bg-gray-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Matches/Woche</p>
                                    <p
                                        id="stats-matches-per-week"
                                        class="text-3xl font-bold text-gray-700"
                                    >
                                        -
                                    </p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Grundlagen-Quote</p>
                                    <p
                                        id="stats-grundlagen-rate"
                                        class="text-3xl font-bold text-gray-700"
                                    >
                                        -
                                    </p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg text-center">
                                    <p class="text-sm text-gray-600 mb-1">Team-Fortschritt</p>
                                    <p
                                        id="stats-team-progress"
                                        class="text-3xl font-bold text-gray-700"
                                    >
                                        -
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Video-Analyse Tab -->
                <div id="tab-content-video-analysis" class="tab-content hidden">
                    <div class="max-w-6xl mx-auto">
                        <!-- Header mit Upload-Button -->
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">Video-Analyse</h2>
                                <p class="text-gray-500 text-sm mt-1">Analysiere Spieler-Videos und gib zeitbasiertes Feedback</p>
                            </div>
                            <button id="open-video-upload-btn"
                                    class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-lg shadow transition-colors flex items-center gap-2">
                                <i class="fas fa-upload"></i>
                                <span>Video hochladen</span>
                            </button>
                        </div>

                        <!-- Sub-Navigation -->
                        <div class="mb-6 border-b border-gray-200">
                            <nav class="flex space-x-6">
                                <button class="video-sub-tab whitespace-nowrap py-3 px-1 border-b-2 border-indigo-600 font-medium text-sm text-indigo-600"
                                        data-video-tab="inbox">
                                    Inbox
                                    <span id="pending-videos-badge" class="ml-1 bg-yellow-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                                </button>
                                <button class="video-sub-tab whitespace-nowrap py-3 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700"
                                        data-video-tab="all">
                                    Alle Videos
                                </button>
                            </nav>
                        </div>

                        <!-- Tab Contents -->
                        <div id="video-tab-inbox" class="video-tab-content">
                            <div id="video-analysis-inbox">
                                <!-- Wird dynamisch gef√ºllt -->
                            </div>
                        </div>

                        <div id="video-tab-all" class="video-tab-content hidden">
                            <div id="video-analysis-all">
                                <!-- Wird dynamisch gef√ºllt -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Video Upload Modal -->
                <div id="video-upload-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center">
                            <h3 class="text-lg font-bold">Video hochladen</h3>
                            <button id="close-video-upload-modal" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="video-upload-form" class="p-6 space-y-4">
                            <!-- Video-Datei -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Video-Datei *</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-indigo-500 transition-colors">
                                    <input type="file" id="video-file-input" accept="video/mp4,video/quicktime,video/webm" required
                                           class="hidden">
                                    <label for="video-file-input" class="cursor-pointer">
                                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                                        <p class="text-sm text-gray-600">Klicken zum Ausw√§hlen oder Datei hierher ziehen</p>
                                        <p class="text-xs text-gray-400 mt-1">MP4, MOV, WebM (max. 100 MB)</p>
                                    </label>
                                </div>
                                <p id="selected-file-name" class="text-sm text-indigo-600 mt-2 hidden"></p>
                            </div>

                            <!-- Titel -->
                            <div>
                                <label for="video-title-input" class="block text-sm font-medium text-gray-700 mb-1">Titel (optional)</label>
                                <input type="text" id="video-title-input" placeholder="z.B. Aufschlag-Technik"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>

                            <!-- Video-Datum -->
                            <div>
                                <label for="video-date-input" class="block text-sm font-medium text-gray-700 mb-1">Datum des Videos</label>
                                <input type="date" id="video-date-input"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                <p class="text-xs text-gray-400 mt-1">Wann wurde das Video aufgenommen?</p>
                            </div>

                            <!-- √úbung -->
                            <div>
                                <label for="video-exercise-select" class="block text-sm font-medium text-gray-700 mb-1">√úbung zuordnen</label>
                                <select id="video-exercise-select"
                                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="">Keine √úbung</option>
                                </select>
                            </div>

                            <!-- Tags -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                                <div id="video-tags-container" class="flex flex-wrap gap-2 mb-2">
                                    <!-- Tags werden dynamisch eingef√ºgt -->
                                </div>
                                <!-- Custom Tag Input -->
                                <div class="flex gap-2 mt-2">
                                    <input type="text" id="custom-tag-input"
                                           placeholder="Eigenen Tag hinzuf√ºgen..."
                                           class="flex-1 px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                           maxlength="30">
                                    <button type="button" id="add-custom-tag-btn"
                                            class="px-3 py-1.5 bg-indigo-100 text-indigo-700 rounded-lg text-sm font-medium hover:bg-indigo-200 transition-colors">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Spieler-Zuweisung -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Spieler zuweisen</label>
                                <div id="video-player-assignment-list" class="max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2">
                                    <!-- Spieler werden dynamisch eingef√ºgt -->
                                </div>
                            </div>

                            <!-- KI-Training Consent (DSGVO) -->
                            <div class="border border-gray-200 rounded-lg p-3 bg-gray-50">
                                <label class="flex items-start gap-3 cursor-pointer">
                                    <input type="checkbox" id="coach-allow-ai-training"
                                           class="w-5 h-5 mt-0.5 rounded text-indigo-600 focus:ring-indigo-500">
                                    <div>
                                        <span class="font-medium text-gray-800 text-sm">KI-Verbesserung unterst√ºtzen</span>
                                        <p class="text-xs text-gray-600 mt-0.5">
                                            Dieses Video darf anonymisiert zur Verbesserung der automatischen Schlag-Erkennung genutzt werden.
                                        </p>
                                    </div>
                                </label>
                            </div>

                            <!-- Upload Progress -->
                            <div id="video-upload-progress" class="hidden">
                                <div class="mb-2 flex justify-between text-sm">
                                    <span id="upload-status-text" class="text-gray-600">Wird vorbereitet...</span>
                                    <span id="upload-percent-text" class="font-medium text-indigo-600">0%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                    <div id="upload-progress-bar" class="bg-indigo-600 h-full rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                                <p id="upload-size-text" class="text-xs text-gray-500 mt-1 text-center"></p>
                            </div>

                            <!-- Submit -->
                            <button type="submit" id="coach-video-submit-btn"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2">
                                <i class="fas fa-upload"></i>
                                <span>Hochladen</span>
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Video Detail Modal -->
                <div id="video-detail-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4">
                    <div class="bg-white rounded-xl shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col mx-2">
                        <!-- Header - sticky so close button is always visible -->
                        <div class="border-b px-3 sm:px-6 py-3 sm:py-4 flex justify-between items-center flex-shrink-0 sticky top-0 bg-white z-10">
                            <h3 class="text-base sm:text-lg font-bold truncate mr-2">Video analysieren</h3>
                            <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                                <button id="draw-on-video-btn" class="bg-orange-500 hover:bg-orange-600 active:bg-orange-700 text-white text-xs sm:text-sm font-medium py-2 px-2 sm:px-3 rounded-lg transition-colors" title="Auf Video zeichnen">
                                    <i class="fas fa-pen"></i><span class="hidden sm:inline ml-1">Zeichnen</span>
                                </button>
                                <button id="compare-video-btn" class="bg-purple-600 hover:bg-purple-700 active:bg-purple-800 text-white text-xs sm:text-sm font-medium py-2 px-2 sm:px-3 rounded-lg transition-colors" title="Vergleichen">
                                    <i class="fas fa-columns"></i><span class="hidden sm:inline ml-1">Vergleichen</span>
                                </button>
                                <button id="mark-reviewed-btn" class="bg-green-600 hover:bg-green-700 active:bg-green-800 text-white text-xs sm:text-sm font-medium py-2 px-2 sm:px-3 rounded-lg transition-colors" title="Als analysiert markieren">
                                    <i class="fas fa-check"></i><span class="hidden sm:inline ml-1">Analysiert</span>
                                </button>
                                <button id="close-video-detail-modal" class="text-gray-500 hover:text-gray-700 active:text-gray-900 p-2 -mr-2">
                                    <i class="fas fa-times text-xl sm:text-2xl"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="flex-1 overflow-y-auto">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 p-3 sm:p-6">
                                <!-- Video Player -->
                                <div id="video-player-container">
                                    <!-- Video wird dynamisch eingef√ºgt -->
                                </div>

                                <!-- Kommentare -->
                                <div class="flex flex-col">
                                    <h4 class="font-bold text-gray-800 mb-4">Kommentare & Feedback</h4>

                                    <!-- Kommentar-Eingabe -->
                                    <form id="video-comment-form" class="mb-4">
                                        <div class="flex gap-2">
                                            <input type="text" id="video-comment-input"
                                                   placeholder="Feedback eingeben..."
                                                   class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                            <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors">
                                                <i class="fas fa-paper-plane"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center gap-2 mt-2">
                                            <input type="checkbox" id="include-timestamp-checkbox" checked class="rounded text-indigo-600">
                                            <label for="include-timestamp-checkbox" class="text-sm text-gray-600">
                                                Aktuelle Video-Position anh√§ngen
                                            </label>
                                        </div>
                                    </form>

                                    <!-- Kommentar-Liste -->
                                    <div id="video-comments-list" class="flex-1 overflow-y-auto max-h-96">
                                        <!-- Kommentare werden dynamisch eingef√ºgt -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Split-Screen Modal -->
                <div id="split-screen-modal" class="hidden fixed inset-0 bg-black/90 z-50 overflow-hidden">
                    <div class="h-full w-full flex flex-col">
                        <!-- Header -->
                        <div class="bg-gray-900 text-white p-3 sm:p-4 flex items-center justify-between flex-shrink-0">
                            <h2 class="text-base sm:text-lg font-semibold flex items-center gap-2">
                                <i class="fas fa-columns"></i>
                                <span class="hidden sm:inline">Video-Vergleich</span>
                                <span class="sm:hidden">Vergleich</span>
                            </h2>
                            <div class="flex items-center gap-2 sm:gap-4">
                                <!-- Sync Toggle -->
                                <label class="flex items-center gap-1 sm:gap-2 text-xs sm:text-sm">
                                    <input type="checkbox" id="coach-sync-playback" checked
                                           class="rounded text-indigo-600 focus:ring-indigo-500">
                                    <span class="hidden sm:inline">Synchron abspielen</span>
                                    <span class="sm:hidden">Sync</span>
                                </label>
                                <button id="close-split-screen-modal" class="text-white hover:text-gray-300 transition-colors p-2 -mr-2">
                                    <i class="fas fa-times text-xl sm:text-2xl"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Video Container -->
                        <div class="flex-1 flex flex-col lg:flex-row gap-2 p-2 sm:p-4 overflow-hidden min-h-0">
                            <!-- Left Video -->
                            <div class="flex-1 flex flex-col min-h-0">
                                <div class="bg-gray-800 rounded-lg p-2 sm:p-3 mb-2 flex-shrink-0">
                                    <select id="split-video-select-left" class="w-full bg-gray-700 text-white px-2 sm:px-3 py-2 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-indigo-500">
                                        <option value="">Video 1 ausw√§hlen...</option>
                                    </select>
                                </div>
                                <div class="flex-1 bg-black rounded-lg overflow-hidden flex items-center justify-center min-h-0">
                                    <video id="split-video-left" class="max-w-full max-h-full" controls playsinline></video>
                                </div>
                                <div id="split-info-left" class="bg-gray-800 rounded-lg p-2 sm:p-3 mt-2 text-white text-xs sm:text-sm hidden flex-shrink-0">
                                    <p class="font-medium truncate" id="split-title-left"></p>
                                    <p class="text-gray-400 text-xs" id="split-date-left"></p>
                                </div>
                            </div>

                            <!-- Right Video -->
                            <div class="flex-1 flex flex-col min-h-0">
                                <div class="bg-gray-800 rounded-lg p-2 sm:p-3 mb-2 flex-shrink-0">
                                    <select id="split-video-select-right" class="w-full bg-gray-700 text-white px-2 sm:px-3 py-2 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-indigo-500">
                                        <option value="">Video 2 ausw√§hlen...</option>
                                    </select>
                                </div>
                                <div class="flex-1 bg-black rounded-lg overflow-hidden flex items-center justify-center min-h-0">
                                    <video id="split-video-right" class="max-w-full max-h-full" controls playsinline></video>
                                </div>
                                <div id="split-info-right" class="bg-gray-800 rounded-lg p-2 sm:p-3 mt-2 text-white text-xs sm:text-sm hidden flex-shrink-0">
                                    <p class="font-medium truncate" id="split-title-right"></p>
                                    <p class="text-gray-400 text-xs" id="split-date-right"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Playback Controls -->
                        <div class="bg-gray-900 p-3 sm:p-4 flex items-center justify-center gap-2 sm:gap-4 flex-shrink-0">
                            <button id="play-both-btn" class="bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 text-white px-4 sm:px-6 py-2 rounded-lg flex items-center gap-2 transition-colors text-sm sm:text-base">
                                <i class="fas fa-play"></i>
                                <span class="hidden sm:inline">Abspielen</span>
                            </button>
                            <button id="restart-both-btn" class="bg-gray-700 hover:bg-gray-600 active:bg-gray-500 text-white px-3 sm:px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-redo"></i>
                            </button>
                            <div class="text-white text-sm">
                                <span id="split-time">0:00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-content-subgroups" class="tab-content hidden">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h2 class="text-lg font-semibold text-blue-900 mb-2">
                                üìö Was sind Untergruppen?
                            </h2>
                            <p class="text-sm text-blue-800">
                                Untergruppen erm√∂glichen es dir, mehrere Trainingsgruppen innerhalb
                                deines Vereins zu verwalten (z.B. "U10", "U13", "Leistungsteam").
                                Jede Gruppe hat separate Anwesenheitslisten und Streaks, w√§hrend
                                Elo, XP und R√§nge f√ºr alle Spieler global bleiben.
                            </p>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md">
                                <h2 class="text-xl font-semibold mb-4">
                                    Neue Untergruppe erstellen
                                </h2>
                                <form id="create-subgroup-form" class="space-y-4">
                                    <div>
                                        <label
                                            for="subgroup-name"
                                            class="block text-sm font-medium text-gray-700"
                                            >Gruppenname</label
                                        >
                                        <input
                                            type="text"
                                            id="subgroup-name"
                                            required
                                            placeholder="z.B. U10, Leistungsteam"
                                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                        />
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2"
                                            >Farbe f√ºr Kalender</label
                                        >
                                        <div class="flex gap-2 flex-wrap">
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#6366f1"
                                                    class="sr-only peer"
                                                    checked
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-indigo-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-indigo-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#ef4444"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-red-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-red-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#10b981"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-green-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-green-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#f59e0b"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-amber-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-amber-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#8b5cf6"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-violet-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-violet-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#ec4899"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-pink-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-pink-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#06b6d4"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-cyan-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-cyan-300"
                                                ></div>
                                            </label>
                                            <label class="inline-flex items-center cursor-pointer">
                                                <input
                                                    type="radio"
                                                    name="subgroup-color"
                                                    value="#84cc16"
                                                    class="sr-only peer"
                                                />
                                                <div
                                                    class="w-10 h-10 rounded-full bg-lime-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-lime-300"
                                                ></div>
                                            </label>
                                        </div>
                                    </div>
                                    <button
                                        type="submit"
                                        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105"
                                    >
                                        Gruppe erstellen
                                    </button>
                                    <p
                                        id="subgroup-form-feedback"
                                        class="mt-3 text-sm font-medium text-center"
                                    ></p>
                                </form>
                            </div>

                            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-md">
                                <h2 class="text-xl font-semibold mb-4">Bestehende Untergruppen</h2>
                                <div id="subgroups-list" class="space-y-4">
                                    <p class="text-gray-500 text-center py-8">
                                        Lade Untergruppen...
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <div
            id="exercise-modal"
            class="modal fixed inset-0 bg-gray-800/75 h-full w-full hidden z-50 flex justify-center items-start py-8 overflow-y-auto"
        >
            <div
                class="relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white my-auto"
            >
                <!-- Close button - absolute positioned with shadow -->
                <button
                    id="close-exercise-modal-button"
                    class="absolute top-3 right-3 text-gray-700 hover:text-gray-900 bg-white hover:bg-gray-100 rounded-full p-2 transition-colors shadow-lg border border-gray-200"
                    style="z-index: 9999"
                >
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M6 18L18 6M6 6l12 12"
                        />
                    </svg>
                </button>
                <div class="mb-4 pr-10">
                    <h3
                        id="modal-exercise-title"
                        class="text-xl leading-6 font-medium text-gray-900"
                    ></h3>
                </div>
                <img
                    id="modal-exercise-image"
                    src=""
                    alt="√úbungsbild"
                    class="w-full max-h-96 object-contain rounded-md mb-4"
                />

                <!-- Animation Container -->
                <div id="modal-exercise-animation" class="hidden mb-4">
                    <div class="bg-slate-900 rounded-lg p-2 relative">
                        <canvas id="modal-animation-canvas" class="w-full" style="height: 300px;"></canvas>
                        <div class="absolute bottom-3 right-3">
                            <button
                                id="modal-animation-play-pause"
                                class="bg-white/90 hover:bg-white text-slate-800 text-xs px-3 py-1.5 rounded-md shadow-md transition-colors"
                            >
                                <i class="fas fa-pause mr-1"></i>Pause
                            </button>
                        </div>
                    </div>
                </div>

                <div id="modal-exercise-tags" class="mb-4"></div>
                <p
                    id="modal-exercise-description"
                    class="text-sm text-gray-600 mb-4"
                    style="white-space: pre-wrap"
                ></p>

                <!-- Ablauf/Procedure Section -->
                <div id="modal-exercise-procedure" class="hidden"></div>

                <!-- Musterbeispiele Section (nur f√ºr Coach) -->
                <div id="exercise-example-videos-section" class="mb-4 border-t border-gray-200 pt-4">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-medium text-gray-900 flex items-center gap-2">
                            <i class="fas fa-video text-indigo-600"></i>
                            Musterbeispiele
                        </h4>
                        <button id="add-example-video-btn"
                                class="text-sm bg-indigo-100 text-indigo-700 px-3 py-1 rounded-lg hover:bg-indigo-200 transition-colors flex items-center gap-1">
                            <i class="fas fa-plus text-xs"></i>
                            Video hinzuf√ºgen
                        </button>
                    </div>
                    <div id="exercise-example-videos-list" class="space-y-2">
                        <p class="text-sm text-gray-500 text-center py-4">
                            Noch keine Musterbeispiele vorhanden
                        </p>
                    </div>
                </div>

                <!-- Abk√ºrzungen Legende -->
                <div class="mb-4 border-t border-gray-200 pt-3">
                    <button
                        id="toggle-abbreviations-coach"
                        class="flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800 font-medium"
                    >
                        <svg
                            id="abbreviations-icon-coach"
                            class="w-4 h-4 transform transition-transform"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M19 9l-7 7-7-7"
                            ></path>
                        </svg>
                        üìñ Abk√ºrzungen anzeigen
                    </button>
                    <div
                        id="abbreviations-content-coach"
                        class="hidden mt-3 bg-gray-50 rounded-lg p-3"
                    >
                        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs">
                            <div><span class="font-semibold">VH</span> = Vorhand</div>
                            <div><span class="font-semibold">RH</span> = R√ºckhand</div>
                            <div><span class="font-semibold">T</span> = Topspin</div>
                            <div><span class="font-semibold">K</span> = Konter</div>
                            <div><span class="font-semibold">B</span> = Block</div>
                            <div><span class="font-semibold">S</span> = Smash</div>
                            <div><span class="font-semibold">F</span> = Flip</div>
                            <div><span class="font-semibold">SCH</span> = Schupf</div>
                            <div><span class="font-semibold">U</span> = Unterschnitt - Abwehr</div>
                            <div><span class="font-semibold">A</span> = Aufschlag</div>
                            <div><span class="font-semibold">OS</span> = Oberschnitt</div>
                            <div><span class="font-semibold">US</span> = Unterschnitt</div>
                            <div><span class="font-semibold">SS</span> = Seitenschnitt</div>
                        </div>
                    </div>
                </div>

                <!-- Milestones display -->
                <div id="modal-exercise-milestones"></div>

                <div class="text-right">
                    <span
                        id="modal-exercise-points"
                        class="font-bold text-indigo-600 bg-indigo-100 px-3 py-1 rounded-full text-md"
                    ></span>
                </div>
            </div>
        </div>

        <!-- Modal: Video als Musterbeispiel ausw√§hlen -->
        <div id="select-example-video-modal"
             class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-[60] flex justify-center items-start p-4 sm:py-8">
            <div class="relative mx-auto p-4 sm:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white my-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-base sm:text-lg font-medium text-gray-900">
                        <i class="fas fa-video text-indigo-600 mr-2"></i>
                        <span class="hidden sm:inline">Musterbeispiel ausw√§hlen</span>
                        <span class="sm:hidden">Ausw√§hlen</span>
                    </h3>
                    <button id="close-select-example-video-modal" class="text-gray-400 hover:text-gray-600 p-2 -mr-2">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <p class="text-xs sm:text-sm text-gray-600 mb-4">
                    W√§hle ein oder mehrere Videos als Musterbeispiel f√ºr diese √úbung.
                </p>

                <!-- Video Grid -->
                <div id="example-video-selection-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 max-h-72 sm:max-h-96 overflow-y-auto mb-4">
                    <p class="col-span-full text-center py-8 text-gray-500">
                        <i class="fas fa-spinner fa-spin mr-2"></i>
                        Lade Videos...
                    </p>
                </div>

                <!-- Actions -->
                <div class="flex justify-end gap-2 sm:gap-3 border-t pt-4">
                    <button id="cancel-select-example-video"
                            class="px-3 sm:px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 active:bg-gray-100 transition-colors text-sm">
                        Abbrechen
                    </button>
                    <button id="confirm-select-example-video"
                            class="px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 active:bg-indigo-800 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm"
                            disabled>
                        <i class="fas fa-check"></i>
                        <span id="confirm-example-count">Ausw√§hlen</span>
                    </button>
                </div>
            </div>
        </div>

        <div
            id="attendance-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Anwesenheit am <span id="attendance-modal-date"></span>
                    </h3>
                    <button
                        id="close-attendance-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <form id="attendance-form" class="space-y-4">
                    <input type="hidden" id="attendance-date-input" />
                    <input type="hidden" id="attendance-doc-id-input" />

                    <!-- Coach selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Anwesende Trainer (mehrere ausw√§hlbar)
                        </label>
                        <div
                            id="attendance-coach-list"
                            class="border border-gray-300 rounded-md px-3 py-2 max-h-32 overflow-y-auto space-y-1"
                        >
                            <p class="text-sm text-gray-400">Trainer werden geladen...</p>
                        </div>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-md font-medium text-gray-800">Anwesende Spieler</h4>
                            <span id="attendance-count" class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-sm font-semibold">0 / 0</span>
                        </div>
                        <div class="flex items-center gap-2 mb-3">
                            <button type="button" id="select-all-players-btn" class="px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition-colors">
                                Alle ausw√§hlen
                            </button>
                            <button type="button" id="deselect-all-players-btn" class="px-3 py-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded-lg transition-colors">
                                Keine
                            </button>
                        </div>
                        <div
                            id="attendance-player-list"
                            class="mt-2 space-y-2 max-h-60 overflow-y-auto border p-2 rounded-md"
                        >
                            <p class="text-gray-400">Spieler werden geladen...</p>
                        </div>
                    </div>
                    <div>
                        <button
                            type="submit"
                            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                        >
                            Anwesenheit speichern
                        </button>
                        <p
                            id="attendance-feedback"
                            class="mt-3 text-sm font-medium text-center"
                        ></p>
                    </div>
                </form>

                <div class="mt-6 border-t pt-4">
                    <h4 class="text-md font-medium text-gray-800">Wettkampf-Paarungen</h4>
                    <p class="text-sm text-gray-500 mb-3">
                        Erstellt zuf√§llige Matches f√ºr alle anwesenden und match-bereiten Spieler.
                    </p>
                    <button
                        id="generate-pairings-button"
                        class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        <i class="fas fa-random mr-2"></i> Paarungen erstellen
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Quick Points after Attendance -->
        <div
            id="quick-points-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Punkte vergeben
                    </h3>
                    <button
                        id="close-quick-points-modal"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <div class="space-y-4">
                    <!-- Player Selection -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700">
                                Spieler ausw√§hlen (Mehrfachauswahl)
                            </label>
                            <span id="quick-points-player-count" class="px-2 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs font-semibold">0 ausgew√§hlt</span>
                        </div>
                        <div class="flex items-center gap-2 mb-2">
                            <button type="button" id="quick-points-select-all" class="px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium rounded transition-colors">
                                Alle
                            </button>
                            <button type="button" id="quick-points-select-none" class="px-2 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 text-xs font-medium rounded transition-colors">
                                Keine
                            </button>
                        </div>
                        <div
                            id="quick-points-player-list"
                            class="border border-gray-300 rounded-md p-2 max-h-40 overflow-y-auto space-y-1"
                        >
                            <p class="text-sm text-gray-400">Keine Spieler vorhanden</p>
                        </div>
                    </div>

                    <!-- Points Type Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Art der Punkte</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button type="button" id="quick-points-type-exercise" class="quick-points-type-btn px-3 py-2 border-2 border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:border-indigo-500 hover:bg-indigo-50 transition-colors">
                                √úbung
                            </button>
                            <button type="button" id="quick-points-type-challenge" class="quick-points-type-btn px-3 py-2 border-2 border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:border-indigo-500 hover:bg-indigo-50 transition-colors">
                                Challenge
                            </button>
                            <button type="button" id="quick-points-type-manual" class="quick-points-type-btn px-3 py-2 border-2 border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:border-indigo-500 hover:bg-indigo-50 transition-colors">
                                Manuell
                            </button>
                        </div>
                    </div>

                    <!-- Exercise Selection (hidden by default) -->
                    <div id="quick-points-exercise-container" class="hidden">
                        <label for="quick-points-exercise-select" class="block text-sm font-medium text-gray-700">√úbung ausw√§hlen</label>
                        <select
                            id="quick-points-exercise-select"
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                        >
                            <option value="">√úbung w√§hlen...</option>
                        </select>
                        <!-- Milestone input for exercises -->
                        <div id="quick-points-exercise-milestone" class="hidden mt-2 bg-indigo-50 border border-indigo-200 rounded-lg p-3">
                            <label class="block text-sm font-medium text-indigo-900 mb-1">Anzahl Wiederholungen</label>
                            <input
                                type="number"
                                id="quick-points-exercise-count"
                                min="1"
                                placeholder="z.B. 10"
                                class="block w-full px-3 py-2 text-base border-indigo-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                            <p id="quick-points-exercise-milestone-info" class="mt-1 text-xs text-indigo-700"></p>
                        </div>

                        <!-- Spielmodus Auswahl (Balleimer vs Paarung) -->
                        <div id="quick-points-play-mode-container" class="hidden mt-3">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Spielmodus</label>
                            <div class="flex gap-2">
                                <button
                                    type="button"
                                    id="quick-points-mode-solo"
                                    class="flex-1 py-2 px-3 text-sm font-medium rounded-lg border-2 border-gray-300 text-gray-700 hover:border-indigo-500 hover:text-indigo-600 transition-colors"
                                >
                                    <i class="fas fa-robot mr-1"></i> Balleimer/Roboter
                                </button>
                                <button
                                    type="button"
                                    id="quick-points-mode-pair"
                                    class="flex-1 py-2 px-3 text-sm font-medium rounded-lg border-2 border-gray-300 text-gray-700 hover:border-indigo-500 hover:text-indigo-600 transition-colors"
                                >
                                    <i class="fas fa-user-friends mr-1"></i> Paarung
                                </button>
                            </div>

                            <!-- Info f√ºr Paarung-Modus -->
                            <div id="quick-points-pair-info" class="hidden mt-2 bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <p id="quick-points-pair-text" class="text-sm text-blue-800">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    <strong>Paarung:</strong> W√§hle zwei Spieler aus.
                                </p>
                                <p id="quick-points-pair-points-info" class="text-xs text-blue-600 mt-1"></p>
                            </div>

                            <!-- Paar-Auswahl Container -->
                            <div id="quick-points-pair-selection" class="hidden mt-3 space-y-2">
                                <div class="flex items-center gap-2">
                                    <span class="text-sm font-medium text-gray-700 w-24">Spieler A:</span>
                                    <select id="quick-points-player-a" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500">
                                        <option value="">Spieler A w√§hlen...</option>
                                    </select>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-sm font-medium text-gray-700 w-24">Spieler B:</span>
                                    <select id="quick-points-player-b" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500">
                                        <option value="">Spieler B w√§hlen...</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Zeit-Eingabe f√ºr Zeit-basierte √úbungen -->
                        <div id="quick-points-time-input-container" class="hidden mt-2 bg-purple-50 border border-purple-200 rounded-lg p-3">
                            <label class="block text-sm font-medium text-purple-900 mb-1">Zeit eingeben</label>
                            <div class="flex items-center gap-1">
                                <input type="number" id="quick-points-time-hours" min="0" max="23" value="0" placeholder="00" class="w-16 px-2 py-2 text-center border border-purple-300 rounded-md text-sm" />
                                <span class="text-purple-700">:</span>
                                <input type="number" id="quick-points-time-minutes" min="0" max="59" value="0" placeholder="00" class="w-16 px-2 py-2 text-center border border-purple-300 rounded-md text-sm" />
                                <span class="text-purple-700">:</span>
                                <input type="number" id="quick-points-time-seconds" min="0" max="59" value="0" placeholder="00" class="w-16 px-2 py-2 text-center border border-purple-300 rounded-md text-sm" />
                            </div>
                            <p class="text-xs text-purple-600 mt-1">Format: Stunden : Minuten : Sekunden</p>
                        </div>
                    </div>

                    <!-- Challenge Selection (hidden by default) -->
                    <div id="quick-points-challenge-container" class="hidden">
                        <label for="quick-points-challenge-select" class="block text-sm font-medium text-gray-700">Challenge ausw√§hlen</label>
                        <select
                            id="quick-points-challenge-select"
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                        >
                            <option value="">Challenge w√§hlen...</option>
                        </select>
                        <!-- Milestone input for challenges -->
                        <div id="quick-points-challenge-milestone" class="hidden mt-2 bg-indigo-50 border border-indigo-200 rounded-lg p-3">
                            <label class="block text-sm font-medium text-indigo-900 mb-1">Anzahl Wiederholungen</label>
                            <input
                                type="number"
                                id="quick-points-challenge-count"
                                min="1"
                                placeholder="z.B. 10"
                                class="block w-full px-3 py-2 text-base border-indigo-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                            <p id="quick-points-challenge-milestone-info" class="mt-1 text-xs text-indigo-700"></p>
                        </div>
                    </div>

                    <!-- Manual Points (hidden by default) -->
                    <div id="quick-points-manual-container" class="hidden space-y-3">
                        <div>
                            <label for="quick-points-manual-amount" class="block text-sm font-medium text-gray-700">Punkte (auch negativ m√∂glich)</label>
                            <input
                                type="number"
                                id="quick-points-manual-amount"
                                placeholder="z.B. 10 oder -5"
                                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                            />
                        </div>
                        <div>
                            <label for="quick-points-manual-reason" class="block text-sm font-medium text-gray-700">Begr√ºndung</label>
                            <input
                                type="text"
                                id="quick-points-manual-reason"
                                placeholder="z.B. Gute Leistung, Strafe f√ºr..."
                                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                            />
                        </div>
                    </div>

                    <!-- Points Preview -->
                    <div id="quick-points-preview" class="hidden bg-gray-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Punkte pro Spieler:</span>
                            <span id="quick-points-preview-amount" class="font-bold text-indigo-600">0 Punkte</span>
                        </div>
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-sm text-gray-600">Ausgew√§hlte Spieler:</span>
                            <span id="quick-points-preview-players" class="font-medium text-gray-800">0</span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-3 pt-2">
                        <button
                            type="button"
                            id="quick-points-skip-btn"
                            class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"
                        >
                            Schlie√üen
                        </button>
                        <button
                            type="button"
                            id="quick-points-submit-btn"
                            class="flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            Speichern & Schlie√üen
                        </button>
                        <button
                            type="button"
                            id="quick-points-submit-continue-btn"
                            class="flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            Speichern & Weiter
                        </button>
                    </div>

                    <p id="quick-points-feedback" class="text-sm font-medium text-center"></p>
                </div>
            </div>
        </div>

        <!-- Modal: Recurring Training Template -->
        <div
            id="recurring-training-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto p-6 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3
                        id="recurring-training-modal-title"
                        class="text-xl leading-6 font-medium text-gray-900"
                    >
                        Wiederkehrendes Training erstellen
                    </h3>
                    <button
                        id="close-recurring-training-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <form id="recurring-training-form" class="space-y-4">
                    <input type="hidden" id="recurring-training-id-input" />

                    <div>
                        <label
                            for="recurring-training-day-select"
                            class="block text-sm font-medium text-gray-700"
                            >Wochentag</label
                        >
                        <select
                            id="recurring-training-day-select"
                            required
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                        >
                            <option value="">Bitte w√§hlen...</option>
                            <option value="1">Montag</option>
                            <option value="2">Dienstag</option>
                            <option value="3">Mittwoch</option>
                            <option value="4">Donnerstag</option>
                            <option value="5">Freitag</option>
                            <option value="6">Samstag</option>
                            <option value="0">Sonntag</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label
                                for="recurring-training-start-time"
                                class="block text-sm font-medium text-gray-700"
                                >Startzeit</label
                            >
                            <input
                                type="time"
                                id="recurring-training-start-time"
                                required
                                class="mt-1 block w-full px-3 py-2 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                        </div>
                        <div>
                            <label
                                for="recurring-training-end-time"
                                class="block text-sm font-medium text-gray-700"
                                >Endzeit</label
                            >
                            <input
                                type="time"
                                id="recurring-training-end-time"
                                required
                                class="mt-1 block w-full px-3 py-2 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                        </div>
                    </div>

                    <div>
                        <label
                            for="recurring-training-subgroup-select"
                            class="block text-sm font-medium text-gray-700"
                            >Untergruppe</label
                        >
                        <select
                            id="recurring-training-subgroup-select"
                            required
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                        >
                            <option value="">Bitte w√§hlen...</option>
                            <!-- Dynamisch gef√ºllt -->
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label
                                for="recurring-training-start-date"
                                class="block text-sm font-medium text-gray-700"
                                >G√ºltig ab</label
                            >
                            <input
                                type="date"
                                id="recurring-training-start-date"
                                required
                                class="mt-1 block w-full px-3 py-2 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                        </div>
                        <div>
                            <label
                                for="recurring-training-end-date"
                                class="block text-sm font-medium text-gray-700"
                                >G√ºltig bis (optional)</label
                            >
                            <input
                                type="date"
                                id="recurring-training-end-date"
                                class="mt-1 block w-full px-3 py-2 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                            />
                        </div>
                    </div>

                    <div class="flex space-x-3">
                        <button
                            type="submit"
                            class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                        >
                            Speichern
                        </button>
                        <button
                            type="button"
                            id="cancel-recurring-training-button"
                            class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg"
                        >
                            Abbrechen
                        </button>
                    </div>
                    <p
                        id="recurring-training-feedback"
                        class="mt-3 text-sm font-medium text-center"
                    ></p>
                </form>
            </div>
        </div>

        <!-- Modal: Training Completion -->
        <div
            id="training-completion-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center p-4"
        >
            <div
                class="relative mx-auto p-4 sm:p-6 border w-full max-w-4xl shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto"
            >
                <div class="flex justify-between items-start mb-4">
                    <div class="flex-1 pr-4">
                        <h3 class="text-lg sm:text-xl leading-6 font-medium text-gray-900">
                            Training abschlie√üen
                        </h3>
                        <p
                            class="text-xs sm:text-sm text-gray-600 mt-1"
                            id="completion-session-info"
                        ></p>
                    </div>
                    <button
                        id="close-training-completion-modal-button"
                        class="text-gray-400 hover:text-gray-600 flex-shrink-0"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <form id="training-completion-form" class="space-y-6">
                    <input type="hidden" id="completion-session-id" />
                    <input type="hidden" id="completion-session-date" />

                    <!-- Summary -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-2">üìä Zusammenfassung</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-600">Anwesende Spieler:</span>
                                <span
                                    id="completion-player-count"
                                    class="ml-2 font-bold text-indigo-600"
                                    >0</span
                                >
                            </div>
                            <div>
                                <span class="text-gray-600">Geplante √úbungen:</span>
                                <span
                                    id="completion-planned-count"
                                    class="ml-2 font-bold text-indigo-600"
                                    >0</span
                                >
                            </div>
                        </div>
                    </div>

                    <!-- Editable Checklist -->
                    <div>
                        <div
                            class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-3"
                        >
                            <h4 class="text-md font-medium text-gray-800">Durchgef√ºhrte √úbungen</h4>
                            <button
                                type="button"
                                id="add-spontaneous-exercise-button"
                                class="text-sm bg-green-600 hover:bg-green-700 text-white font-medium px-3 py-1 rounded whitespace-nowrap"
                            >
                                <i class="fas fa-plus mr-1"></i> Spontane √úbung hinzuf√ºgen
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mb-3">
                            Hake ab, was tats√§chlich gemacht wurde. Nicht durchgef√ºhrte √úbungen
                            einfach abhaken lassen.
                        </p>

                        <!-- Planned Exercises (left column) -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h5
                                    class="text-sm font-medium text-gray-700 mb-2 bg-gray-100 px-2 py-1 rounded"
                                >
                                    üìã Geplante √úbungen
                                </h5>
                                <div id="completion-planned-exercises" class="space-y-2">
                                    <!-- Dynamisch gef√ºllt -->
                                </div>
                            </div>

                            <!-- Spontaneous Exercises (right column) -->
                            <div>
                                <h5
                                    class="text-sm font-medium text-gray-700 mb-2 bg-green-100 px-2 py-1 rounded"
                                >
                                    ‚ûï Spontane √úbungen
                                </h5>
                                <div id="completion-spontaneous-exercises" class="space-y-2">
                                    <p class="text-xs text-gray-400 text-center py-4">
                                        Keine spontanen √úbungen hinzugef√ºgt
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit -->
                    <div class="border-t pt-4">
                        <button
                            type="submit"
                            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg"
                        >
                            <i class="fas fa-check mr-2"></i> Abschluss speichern & Punkte vergeben
                        </button>
                        <p
                            id="training-completion-feedback"
                            class="mt-3 text-sm font-medium text-center"
                        ></p>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Exercise Selection for Session Planning -->
        <div
            id="exercise-selection-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-[60] flex justify-center items-center"
        >
            <div
                class="relative mx-auto border w-full max-w-5xl shadow-lg rounded-md bg-white max-h-[90vh] flex flex-col"
            >
                <!-- Header (fixed) -->
                <div class="p-6 pb-4 border-b bg-white rounded-t-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl leading-6 font-medium text-gray-900">
                            √úbung zum Training hinzuf√ºgen
                        </h3>
                        <button
                            id="close-exercise-selection-modal-button"
                            class="text-gray-400 hover:text-gray-600"
                        >
                            <svg
                                class="h-6 w-6"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"
                                />
                            </svg>
                        </button>
                    </div>

                    <!-- Selection Counter -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg text-center">
                        <div id="exercise-selection-counter" class="text-sm">
                            <span class="text-gray-500">Keine √úbungen ausgew√§hlt</span>
                        </div>
                    </div>
                </div>

                <!-- Scrollable Content -->
                <div class="flex-1 overflow-y-auto px-6 py-4">
                    <!-- Search bar -->
                    <div class="mb-3">
                        <input
                            type="text"
                            id="exercise-selection-search"
                            placeholder="üîç √úbung suchen (Name oder Tag)..."
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                        />
                    </div>

                    <!-- Tag filters -->
                    <div class="mb-4">
                        <div class="flex items-center gap-2 flex-wrap" id="exercise-tag-filters">
                            <span class="text-xs text-gray-500">Filter:</span>
                            <button
                                type="button"
                                class="tag-filter-btn active px-3 py-1 text-xs rounded-full border border-gray-300 bg-indigo-100 text-indigo-700 hover:bg-indigo-200 transition"
                                data-tag="all"
                            >
                                Alle
                            </button>
                            <!-- Dynamisch gef√ºllt mit Tags -->
                        </div>
                    </div>

                    <!-- Exercise grid -->
                    <div
                        id="exercise-selection-grid"
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pb-4"
                    >
                        <!-- Dynamisch gef√ºllt -->
                        <div class="col-span-full text-center py-8 text-gray-500">
                            Lade √úbungen...
                        </div>
                    </div>
                </div>

                <!-- Footer with floating button (fixed) -->
                <div class="p-6 pt-4 border-t bg-white rounded-b-md">
                    <button
                        type="button"
                        id="done-selecting-exercises-button"
                        class="w-full bg-gray-400 cursor-not-allowed text-white font-bold py-3 px-4 rounded-lg transition-all"
                        disabled
                    >
                        <i class="fas fa-check mr-2"></i> √úbungen hinzuf√ºgen
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Training Information -->
        <div
            id="training-info-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div
                class="relative mx-auto p-6 border w-full max-w-2xl shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto"
            >
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Trainingsinformationen
                    </h3>
                    <button
                        id="close-training-info-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <!-- Session Info -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <h4 class="font-medium text-gray-900 mb-2">üìÖ Training Details</h4>
                    <div class="space-y-1 text-sm">
                        <p>
                            <span class="text-gray-600">Gruppe:</span>
                            <span
                                id="training-info-subgroup"
                                class="ml-2 font-semibold text-gray-900"
                            ></span>
                        </p>
                        <p>
                            <span class="text-gray-600">Zeit:</span>
                            <span
                                id="training-info-time"
                                class="ml-2 font-semibold text-gray-900"
                            ></span>
                        </p>
                        <p>
                            <span class="text-gray-600">Datum:</span>
                            <span
                                id="training-info-date"
                                class="ml-2 font-semibold text-gray-900"
                            ></span>
                        </p>
                        <p id="training-info-status" class="mt-2"></p>
                    </div>
                </div>

                <!-- Planned Exercises -->
                <div>
                    <h4 class="text-md font-medium text-gray-800 mb-3">üìã Geplante √úbungen</h4>
                    <div id="training-info-exercises-list" class="space-y-2">
                        <!-- Dynamisch gef√ºllt -->
                    </div>
                </div>

                <!-- Completed Exercises (only show if training is completed) -->
                <div id="training-info-completed-section" class="hidden mt-4">
                    <h4 class="text-md font-medium text-gray-800 mb-3">‚úÖ Durchgef√ºhrte √úbungen</h4>
                    <div id="training-info-completed-exercises" class="space-y-2">
                        <!-- Dynamisch gef√ºllt -->
                    </div>
                </div>

                <!-- Single Players (only show if training is completed and has single players) -->
                <div id="training-info-single-players-section" class="hidden mt-4">
                    <h4 class="text-md font-medium text-gray-800 mb-3">üë§ Einzelspieler</h4>
                    <div id="training-info-single-players-list" class="space-y-2">
                        <!-- Dynamisch gef√ºllt -->
                    </div>
                </div>

                <!-- Close Button -->
                <div class="mt-6">
                    <button
                        type="button"
                        id="close-training-info-button"
                        class="w-full bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg"
                    >
                        Schlie√üen
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Partner Pairing for Exercise -->
        <div
            id="partner-pairing-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div
                class="relative mx-auto p-6 border w-full max-w-3xl shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto"
            >
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="text-xl leading-6 font-medium text-gray-900">
                            Partner-Paarungen bilden
                        </h3>
                        <p class="text-sm text-gray-600 mt-1" id="pairing-exercise-name"></p>
                    </div>
                    <button
                        id="close-partner-pairing-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <!-- Instructions -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <h4 class="font-medium text-gray-900 mb-2">üìù Anleitung</h4>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>
                            ‚Ä¢ <strong>Paar bilden:</strong> Klicke auf zwei Spieler ‚Üí W√§hle Ergebnis
                            (Beide / Nur einer / Nicht geschafft)
                        </li>
                        <li>
                            ‚Ä¢ <strong>Mit Trainer:</strong> Klicke auf einen Spieler ‚Üí Button "Mit
                            Trainer trainieren" ‚Üí W√§hle Ergebnis (Geschafft / Nicht geschafft)
                        </li>
                    </ul>
                </div>

                <!-- Available Players -->
                <div class="mb-4">
                    <h4 class="text-md font-medium text-gray-800 mb-3">Verf√ºgbare Spieler</h4>
                    <div id="available-players-list" class="grid grid-cols-2 md:grid-cols-3 gap-2">
                        <!-- Dynamisch gef√ºllt -->
                    </div>
                </div>

                <!-- Single Player Option (when 1 player selected) -->
                <div id="single-player-option-container" class="mb-4 hidden">
                    <!-- Dynamisch gef√ºllt -->
                </div>

                <!-- Formed Pairs -->
                <div class="mb-4">
                    <h4 class="text-md font-medium text-gray-800 mb-3">Gebildete Paare</h4>
                    <div id="formed-pairs-list" class="space-y-2">
                        <p class="text-xs text-gray-400 text-center py-4">
                            Noch keine Paare gebildet
                        </p>
                    </div>
                </div>

                <!-- Single Players -->
                <div id="single-players-container" class="mb-4 hidden">
                    <h4 class="text-md font-medium text-gray-800 mb-3">
                        Einzelspieler (mit Trainer)
                    </h4>
                    <div id="single-players-list" class="space-y-2">
                        <!-- Dynamisch gef√ºllt -->
                    </div>
                </div>

                <!-- Submit -->
                <div class="border-t pt-4">
                    <button
                        type="button"
                        id="confirm-pairing-button"
                        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg"
                    >
                        <i class="fas fa-check mr-2"></i> Paarungen best√§tigen
                    </button>
                    <p id="pairing-feedback" class="mt-3 text-sm font-medium text-center"></p>
                </div>
            </div>
        </div>

        <!-- Modal: Edit Subgroup -->
        <div
            id="edit-subgroup-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto p-6 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Untergruppe bearbeiten
                    </h3>
                    <button
                        id="close-edit-subgroup-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <form id="edit-subgroup-form" class="space-y-4">
                    <input type="hidden" id="edit-subgroup-id" />

                    <div>
                        <label
                            for="edit-subgroup-name"
                            class="block text-sm font-medium text-gray-700"
                            >Gruppenname</label
                        >
                        <input
                            type="text"
                            id="edit-subgroup-name"
                            required
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        />
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2"
                            >Farbe f√ºr Kalender</label
                        >
                        <div class="flex gap-2 flex-wrap">
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#6366f1"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-indigo-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-indigo-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#ef4444"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-red-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-red-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#10b981"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-green-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-green-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#f59e0b"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-amber-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-amber-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#8b5cf6"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-violet-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-violet-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#ec4899"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-pink-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-pink-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#06b6d4"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-cyan-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-cyan-300"
                                ></div>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="edit-subgroup-color"
                                    value="#84cc16"
                                    class="sr-only peer"
                                />
                                <div
                                    class="w-10 h-10 rounded-full bg-lime-500 border-2 border-transparent peer-checked:border-gray-900 peer-checked:ring-2 peer-checked:ring-lime-300"
                                ></div>
                            </label>
                        </div>
                    </div>

                    <div class="flex space-x-3">
                        <button
                            type="submit"
                            class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                        >
                            √Ñnderungen speichern
                        </button>
                        <button
                            type="button"
                            id="cancel-edit-subgroup-button"
                            class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg"
                        >
                            Abbrechen
                        </button>
                    </div>
                    <p id="edit-subgroup-feedback" class="mt-3 text-sm font-medium text-center"></p>
                </form>
            </div>
        </div>

        <div
            id="player-list-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center p-4"
        >
            <div
                class="relative mx-auto border w-full max-w-6xl shadow-lg rounded-2xl bg-white flex flex-col h-[90vh]"
            >
                <div class="flex justify-between items-center p-5 border-b">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">Spielerverwaltung</h3>
                    <button
                        id="close-player-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <div id="modal-loader" class="text-center py-20">
                    <svg
                        class="animate-spin h-8 w-8 text-indigo-600 mx-auto"
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                    >
                        <circle
                            class="opacity-25"
                            cx="12"
                            cy="12"
                            r="10"
                            stroke="currentColor"
                            stroke-width="4"
                        ></circle>
                        <path
                            class="opacity-75"
                            fill="currentColor"
                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                        ></path>
                    </svg>
                    <p class="mt-2 text-sm text-gray-600">Lade Spieler...</p>
                </div>

                <div
                    id="modal-player-list-container"
                    class="hidden flex-grow overflow-hidden flex flex-col md:flex-row"
                >
                    <!-- Spieler-Liste (Links auf Desktop, oben auf Mobile) -->
                    <div
                        class="w-full md:w-1/3 h-full flex flex-col border-b md:border-b-0 md:border-r border-gray-200 bg-gray-50"
                    >
                        <div class="p-3 border-b border-gray-200">
                            <input
                                type="text"
                                id="player-search-input"
                                placeholder="Spieler suchen..."
                                class="w-full px-3 py-2 text-sm border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
                            />
                        </div>
                        <div
                            id="modal-player-list"
                            class="overflow-y-auto flex-grow divide-y divide-gray-200"
                        ></div>
                    </div>

                    <!-- Details Panel (Rechts auf Desktop, Full-Screen Modal auf Mobile) -->
                    <div
                        class="hidden md:flex md:w-2/3 h-full flex-col overflow-hidden"
                        id="player-detail-container-desktop"
                    >
                        <div class="flex-grow overflow-y-auto">
                            <div id="player-detail-panel-desktop" class="p-6 hidden">
                                <h4 class="text-2xl font-bold text-gray-900 mb-6">
                                    Spieler-Details
                                </h4>

                                <div id="player-detail-content-desktop" class="space-y-6"></div>

                                <div class="mt-8 pt-6 border-t border-gray-200">
                                    <h5 class="text-lg font-medium text-gray-900 mb-4">Aktionen</h5>
                                    <div id="player-detail-actions-desktop" class="space-y-3"></div>
                                </div>
                            </div>

                            <div
                                id="player-detail-placeholder-desktop"
                                class="h-full flex items-center justify-center text-center text-gray-500"
                            >
                                <div class="p-6">
                                    <svg
                                        class="mx-auto h-12 w-12 text-gray-400"
                                        xmlns="http://www.w3.org/2000/svg"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke-width="1"
                                        stroke="currentColor"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"
                                        />
                                    </svg>
                                    <h3 class="mt-2 text-sm font-medium text-gray-900">
                                        Spieler ausw√§hlen
                                    </h3>
                                    <p class="mt-1 text-sm text-gray-500">
                                        W√§hle einen Spieler aus der Liste, um Details und Aktionen
                                        anzuzeigen.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Player Details Modal -->
        <div
            id="player-detail-mobile-modal"
            class="md:hidden fixed inset-0 bg-gray-800/75 z-50 hidden"
        >
            <div class="fixed inset-0 overflow-y-auto">
                <div class="flex min-h-full items-end justify-center p-0">
                    <div
                        class="relative w-full bg-white rounded-t-2xl shadow-xl transform transition-all max-h-[90vh] overflow-y-auto"
                    >
                        <div
                            class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center"
                        >
                            <h4 class="text-lg font-semibold text-gray-900">Spieler-Details</h4>
                            <button
                                id="close-player-detail-mobile"
                                class="text-gray-400 hover:text-gray-600"
                            >
                                <svg
                                    class="h-6 w-6"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke="currentColor"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M6 18L18 6M6 6l12 12"
                                    />
                                </svg>
                            </button>
                        </div>

                        <div class="p-6">
                            <div id="player-detail-content-mobile" class="space-y-6"></div>

                            <div class="mt-8 pt-6 border-t border-gray-200">
                                <h5 class="text-lg font-medium text-gray-900 mb-4">Aktionen</h5>
                                <div id="player-detail-actions-mobile" class="space-y-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div
            id="edit-player-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">Spieler bearbeiten</h3>
                    <button
                        id="close-edit-player-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <div id="edit-player-content">
                    <p class="text-sm text-gray-600 mb-4">
                        Spieler: <span id="edit-player-name" class="font-semibold"></span>
                    </p>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2"
                            >Untergruppen-Zugeh√∂rigkeit</label
                        >
                        <div
                            id="edit-player-subgroups-checkboxes"
                            class="space-y-2 max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3"
                        >
                            <p class="text-xs text-gray-500">Lade Gruppen...</p>
                        </div>
                    </div>
                    <button
                        id="save-player-subgroups-button"
                        class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        √Ñnderungen speichern
                    </button>
                    <p id="edit-player-feedback" class="mt-3 text-sm font-medium text-center"></p>
                </div>
            </div>
        </div>

        <div
            id="add-offline-player-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Offline-Spieler erstellen
                    </h3>
                    <button
                        id="close-add-player-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <form id="add-offline-player-form" class="space-y-4">
                    <div>
                        <label for="firstName" class="block text-sm font-medium text-gray-700"
                            >Vorname</label
                        >
                        <input
                            type="text"
                            id="firstName"
                            required
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        />
                    </div>
                    <div>
                        <label for="lastName" class="block text-sm font-medium text-gray-700"
                            >Nachname</label
                        >
                        <input
                            type="text"
                            id="lastName"
                            required
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        />
                    </div>

                    <!-- Geburtstag (Pflichtfeld) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Geburtstag <span class="text-red-500">*</span>
                        </label>
                        <div class="grid grid-cols-3 gap-2">
                            <select
                                id="offline-birthdate-day"
                                required
                                class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                            >
                                <option value="">Tag</option>
                            </select>
                            <select
                                id="offline-birthdate-month"
                                required
                                class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                            >
                                <option value="">Monat</option>
                            </select>
                            <select
                                id="offline-birthdate-year"
                                required
                                class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                            >
                                <option value="">Jahr</option>
                            </select>
                        </div>
                        <!-- Kind-Hinweis (wird per JS angezeigt) -->
                        <div id="child-player-notice" class="hidden mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg">
                            <p class="text-sm text-purple-700">
                                <i class="fas fa-child mr-1"></i>
                                <strong>Kind-Spieler:</strong> Dieser Spieler ist unter 16 Jahren und erh√§lt eingeschr√§nkten Zugang (Kids-Modus).
                            </p>
                        </div>
                    </div>

                    <!-- Geschlecht -->
                    <div>
                        <label for="offline-gender" class="block text-sm font-medium text-gray-700"
                            >Geschlecht</label
                        >
                        <select
                            id="offline-gender"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        >
                            <option value="">Bitte w√§hlen...</option>
                            <option value="male">M√§nnlich</option>
                            <option value="female">Weiblich</option>
                            <option value="diverse">Divers</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2"
                            >Untergruppen zuweisen</label
                        >
                        <div
                            id="player-subgroups-checkboxes"
                            class="space-y-2 max-h-40 overflow-y-auto border border-gray-300 rounded-md p-3"
                        >
                            <p class="text-xs text-gray-500">Lade Gruppen...</p>
                        </div>
                    </div>

                    <div class="border-t border-gray-200 pt-4 mt-4">
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input
                                    id="is-match-ready-checkbox"
                                    type="checkbox"
                                    class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                                />
                            </div>
                            <div class="ml-3 text-sm">
                                <label
                                    for="is-match-ready-checkbox"
                                    class="font-medium text-gray-700"
                                >
                                    Bereits wettkampfsbereit
                                </label>
                                <p class="text-xs text-gray-500 mt-1">
                                    Spieler hat bereits Erfahrung und kann sofort Matches spielen
                                    (√ºberspringt Grundlagen-√úbungen)
                                </p>
                            </div>
                        </div>

                    </div>

                    <div class="border-t border-gray-200 pt-4 mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-3"
                            >Einladung senden? (Optional)</label
                        >
                        <div class="space-y-2">
                            <label class="flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="invitation-type"
                                    value="none"
                                    checked
                                    class="mr-2"
                                />
                                <span class="text-sm">Keine Einladung (nur Offline-Spieler)</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input
                                    type="radio"
                                    name="invitation-type"
                                    value="code"
                                    class="mr-2"
                                />
                                <span class="text-sm">Einladungscode generieren</span>
                            </label>
                        </div>
                    </div>

                    <button
                        type="submit"
                        class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        <i class="fas fa-user-plus mr-2"></i>Spieler erstellen
                    </button>
                </form>

                <!-- Code Display (shown after code generation) -->
                <div id="generated-code-display" class="hidden space-y-4">
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                        <p class="text-sm text-green-800 mb-2 font-semibold">
                            <i class="fas fa-check-circle mr-1"></i>Spieler erstellt & Code
                            generiert!
                        </p>
                        <div class="bg-white border-2 border-green-400 rounded-lg p-4 my-4">
                            <p
                                id="generated-code-text"
                                class="text-3xl font-bold text-gray-900 tracking-wider"
                            >
                                TTV-XXX-YYY
                            </p>
                        </div>
                        <p class="text-xs text-gray-600 mb-4">
                            G√ºltig f√ºr
                            <span id="code-validity-days" class="font-semibold">7 Tage</span>
                        </p>

                        <div class="flex flex-col space-y-2">
                            <button
                                id="copy-code-button"
                                class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg transition"
                            >
                                <i class="fas fa-copy mr-2"></i>Code kopieren
                            </button>
                            <button
                                id="whatsapp-share-button"
                                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition"
                            >
                                <i class="fab fa-whatsapp mr-2"></i>Per WhatsApp teilen
                            </button>
                        </div>
                    </div>

                    <button
                        id="close-after-code-button"
                        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        Schlie√üen
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Einladung an bestehenden Spieler senden -->
        <div
            id="send-invitation-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        <i class="fas fa-paper-plane mr-2 text-indigo-600"></i>Einladung versenden
                    </h3>
                    <button
                        id="close-send-invitation-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>

                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-blue-800">
                        <i class="fas fa-info-circle mr-1"></i>
                        Sende eine Einladung an
                        <strong id="invitation-player-name">Spieler</strong>, damit er/sie sich
                        online anmelden kann.
                    </p>
                </div>

                <form id="send-invitation-form" class="space-y-4">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <p class="text-sm text-blue-800">
                            <i class="fas fa-qrcode mr-2"></i>
                            Ein Einladungscode wird generiert, den du per WhatsApp oder anders mit
                            dem Spieler teilen kannst.
                        </p>
                    </div>

                    <button
                        type="submit"
                        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        <i class="fas fa-key mr-2"></i>Code generieren
                    </button>
                </form>

                <!-- Code Display (after generation) -->
                <div id="send-invitation-code-display" class="hidden space-y-4">
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                        <p class="text-sm text-green-800 mb-2 font-semibold">
                            <i class="fas fa-check-circle mr-1"></i>Code erfolgreich erstellt!
                        </p>
                        <div class="bg-white border-2 border-green-400 rounded-lg p-4 my-4">
                            <p
                                id="send-invitation-code-text"
                                class="text-3xl font-bold text-gray-900 tracking-wider"
                            >
                                TTV-XXX-YYY
                            </p>
                        </div>
                        <p class="text-xs text-gray-600 mb-4">
                            G√ºltig f√ºr <span class="font-semibold">7 Tage</span>
                        </p>

                        <div class="flex flex-col space-y-2">
                            <button
                                id="copy-invitation-code-button"
                                class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg transition"
                            >
                                <i class="fas fa-copy mr-2"></i>Code kopieren
                            </button>
                            <button
                                id="whatsapp-invitation-share-button"
                                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition"
                            >
                                <i class="fab fa-whatsapp mr-2"></i>Per WhatsApp teilen
                            </button>
                        </div>
                    </div>

                    <button
                        id="close-send-invitation-after-code-button"
                        class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg"
                    >
                        Schlie√üen
                    </button>
                </div>
            </div>
        </div>

        <div
            id="pairings-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        <i class="fas fa-random mr-2 text-green-600"></i> Erstellte Paarungen
                    </h3>
                    <button
                        id="close-pairings-modal-button"
                        class="text-gray-400 hover:text-gray-600"
                    >
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <div id="modal-pairings-content" class="space-y-4">
                    <p class="text-center text-gray-500">Paarungen werden geladen...</p>
                </div>
            </div>
        </div>

        <div
            id="reactivate-challenge-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 justify-center items-center"
        >
            <div class="relative mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl leading-6 font-medium text-gray-900">
                        Challenge reaktivieren
                    </h3>
                    <button id="close-reactivate-modal" class="text-gray-400 hover:text-gray-600">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
                <div class="mt-2">
                    <p class="text-sm text-gray-500 mb-4">
                        Challenge:
                        <span id="reactivate-challenge-title" class="font-semibold"></span>
                    </p>

                    <div class="mb-4">
                        <label
                            for="reactivate-challenge-subgroup"
                            class="block text-sm font-medium text-gray-700 mb-2"
                            >Untergruppe</label
                        >
                        <select
                            id="reactivate-challenge-subgroup"
                            required
                            class="w-full px-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 rounded-md"
                        >
                            <option value="all">Alle (Gesamtverein)</option>
                            <!-- Subgroups will be loaded dynamically -->
                        </select>
                    </div>

                    <p class="text-sm text-gray-700 mb-4">Wie lange soll die Challenge laufen?</p>
                    <div class="space-y-3">
                        <button
                            onclick="handleReactivate('daily')"
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg"
                        >
                            üìÖ 1 Tag
                        </button>
                        <button
                            onclick="handleReactivate('weekly')"
                            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-4 rounded-lg"
                        >
                            üìÜ 1 Woche
                        </button>
                        <button
                            onclick="handleReactivate('monthly')"
                            class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg"
                        >
                            üìÖ 1 Monat
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========== EVENT MODALS ========== -->

        <!-- Modal: Event Day Overview -->
        <div
            id="event-day-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-md shadow-lg rounded-xl bg-white overflow-hidden">
                <!-- Header -->
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold text-white" id="event-day-modal-title">
                                Veranstaltungen
                            </h3>
                            <p class="text-indigo-200 text-sm" id="event-day-modal-date"></p>
                        </div>
                        <button id="close-event-day-modal" class="text-white/80 hover:text-white">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-6">
                    <div id="event-day-list" class="space-y-3 mb-6 max-h-64 overflow-y-auto">
                        <!-- Events werden hier dynamisch eingef√ºgt -->
                        <p class="text-gray-500 text-center py-4" id="event-day-empty">
                            Keine Veranstaltungen an diesem Tag
                        </p>
                    </div>

                    <!-- Add Event Button -->
                    <button
                        id="add-event-btn"
                        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-xl flex items-center justify-center gap-2 shadow-lg transition-all hover:shadow-xl"
                    >
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        <span>Veranstaltung erstellen</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Event Type Selection -->
        <div
            id="event-type-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-md shadow-lg rounded-xl bg-white overflow-hidden">
                <!-- Header -->
                <div class="bg-white px-6 py-4 border-b">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <button id="back-event-type-modal" class="text-indigo-600 hover:text-indigo-800">
                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="text-lg font-semibold text-gray-900">Typ ausw√§hlen</h3>
                        </div>
                        <button id="close-event-type-modal" class="text-gray-400 hover:text-gray-600">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-6 space-y-4">
                    <!-- Single Event -->
                    <button
                        id="select-single-event"
                        class="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left flex items-start gap-4"
                    >
                        <div class="w-12 h-12 rounded-lg bg-red-100 flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900">Veranstaltung</h4>
                            <p class="text-sm text-gray-500">Einmalige Veranstaltung erstellen</p>
                        </div>
                    </button>

                    <!-- Recurring Event -->
                    <button
                        id="select-recurring-event"
                        class="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left flex items-start gap-4"
                    >
                        <div class="w-12 h-12 rounded-lg bg-orange-100 flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900">Wiederkehrende Veranstaltung</h4>
                            <p class="text-sm text-gray-500">W√∂chentlich oder monatlich wiederholend</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Target Group Selection -->
        <div
            id="event-target-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-md shadow-lg rounded-xl bg-white overflow-hidden">
                <!-- Header -->
                <div class="bg-white px-6 py-4 border-b">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <button id="back-event-target-modal" class="text-indigo-600 hover:text-indigo-800">
                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="text-lg font-semibold text-gray-900">Veranstaltung erstellen</h3>
                        </div>
                        <button id="close-event-target-modal" class="text-gray-400 hover:text-gray-600">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-6">
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Veranstaltung erstellen in</p>

                    <div class="space-y-3">
                        <!-- Whole Club -->
                        <button
                            id="select-whole-club"
                            class="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all flex items-center justify-between"
                        >
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center">
                                    <svg class="w-6 h-6 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/>
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <h4 class="font-semibold text-gray-900">Ganzer Verein</h4>
                                    <p class="text-sm text-gray-500">Alle Mitglieder einladen</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                        </button>

                        <!-- Subgroups -->
                        <button
                            id="select-subgroups"
                            class="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all flex items-center justify-between"
                        >
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center">
                                    <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <h4 class="font-semibold text-gray-900">Untergruppen</h4>
                                    <p class="text-sm text-gray-500">Bestimmte Gruppen ausw√§hlen</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Subgroup Selection -->
        <div
            id="event-subgroup-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-md shadow-lg rounded-xl bg-white overflow-hidden">
                <!-- Header -->
                <div class="bg-white px-6 py-4 border-b">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <button id="back-event-subgroup-modal" class="text-indigo-600 hover:text-indigo-800">
                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="text-lg font-semibold text-gray-900">Untergruppen ausw√§hlen</h3>
                        </div>
                        <button id="close-event-subgroup-modal" class="text-gray-400 hover:text-gray-600">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-6">
                    <div id="event-subgroup-list" class="space-y-3 max-h-80 overflow-y-auto mb-6">
                        <!-- Subgroups dynamisch eingef√ºgt -->
                    </div>

                    <button
                        id="confirm-subgroups-btn"
                        disabled
                        class="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-4 rounded-xl transition-all"
                    >
                        Weiter
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Member Selection -->
        <div
            id="event-members-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-md shadow-lg rounded-xl bg-white overflow-hidden max-h-[90vh] flex flex-col">
                <!-- Header -->
                <div class="bg-white px-6 py-4 border-b flex-shrink-0">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <button id="back-event-members-modal" class="text-indigo-600 hover:text-indigo-800">
                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="text-lg font-semibold text-gray-900">Veranstaltung erstellen</h3>
                        </div>
                        <button id="event-members-next-btn" class="text-indigo-600 font-semibold hover:text-indigo-800">
                            Weiter
                        </button>
                    </div>
                </div>

                <!-- Selected Count -->
                <div class="bg-gray-100 px-6 py-2 text-sm text-gray-600 flex-shrink-0">
                    <span id="event-members-count">Keine Empf√§nger ausgew√§hlt</span>
                </div>

                <!-- Tabs -->
                <div class="flex border-b flex-shrink-0">
                    <button id="event-members-tab-members" class="flex-1 py-3 text-sm font-medium text-indigo-600 border-b-2 border-indigo-600 bg-gray-50" onclick="window.switchRecipientTab('members')">
                        Mitglieder
                    </button>
                    <button id="event-members-tab-guardians" class="flex-1 py-3 text-sm font-medium text-gray-500 border-b-2 border-transparent" onclick="window.switchRecipientTab('guardians')">
                        Vormunde
                    </button>
                </div>

                <!-- Content: Mitglieder -->
                <div id="event-members-content" class="p-4 overflow-y-auto flex-1">
                    <!-- Select All Row -->
                    <div class="flex justify-between items-center mb-4 pb-3 border-b">
                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Mitglieder (<span id="event-members-total">0</span>)</p>
                        </div>
                        <button id="event-select-all-members" class="text-indigo-600 text-sm font-semibold hover:text-indigo-800">
                            Alle ausw√§hlen
                        </button>
                    </div>

                    <!-- Member List -->
                    <div id="event-members-list" class="space-y-2">
                        <!-- Members dynamisch eingef√ºgt -->
                    </div>
                </div>

                <!-- Content: Vormunde -->
                <div id="event-guardians-content" class="p-4 overflow-y-auto flex-1 hidden">
                    <!-- Info Text -->
                    <div class="flex justify-between items-center mb-4 pb-3 border-b">
                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">VORMUNDE (<span id="event-guardians-total">0</span>)</p>
                            <p class="text-xs text-gray-400 mt-1 leading-relaxed">Die Vormunde werden normalerweise eingeladen, wenn es sich um Elternversammlungen oder Freiwilligenarbeit handelt</p>
                        </div>
                        <button id="event-select-all-guardians" class="text-indigo-600 text-sm font-semibold hover:text-indigo-800 flex-shrink-0">
                            Alle ausw√§hlen
                        </button>
                    </div>

                    <!-- Guardian List -->
                    <div id="event-guardians-list" class="space-y-2">
                        <!-- Guardians dynamisch eingef√ºgt -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Event Creation Form -->
        <div
            id="event-form-modal"
            class="modal fixed inset-0 bg-gray-800/75 overflow-y-auto h-full w-full hidden z-50 flex justify-center items-center"
        >
            <div class="relative mx-auto border w-full max-w-lg shadow-lg rounded-xl bg-white overflow-hidden max-h-[90vh] flex flex-col">
                <!-- Header -->
                <div class="bg-white px-6 py-4 border-b flex-shrink-0">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <button id="back-event-form-modal" class="text-indigo-600 hover:text-indigo-800">
                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="text-lg font-semibold text-gray-900">Veranstaltung erstellen</h3>
                        </div>
                        <button id="event-form-submit-btn" class="text-indigo-600 font-semibold hover:text-indigo-800">
                            Senden
                        </button>
                    </div>
                </div>

                <!-- Form Content -->
                <div class="p-6 overflow-y-auto flex-1">
                    <form id="event-creation-form" class="space-y-6">
                        <!-- Basic Info -->
                        <div class="bg-gray-50 rounded-xl p-4 space-y-4">
                            <div class="flex items-center gap-3">
                                <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                                <input
                                    type="text"
                                    id="event-title"
                                    placeholder="Titel der Veranstaltung"
                                    required
                                    class="flex-1 bg-transparent border-none focus:ring-0 text-gray-900 placeholder-gray-400"
                                />
                            </div>
                            <div class="flex items-start gap-3 border-t pt-4">
                                <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <textarea
                                    id="event-description"
                                    placeholder="Beschreibung"
                                    rows="2"
                                    class="flex-1 bg-transparent border-none focus:ring-0 text-gray-900 placeholder-gray-400 resize-none"
                                ></textarea>
                            </div>
                            <!-- Event Type -->
                            <div class="flex items-center gap-3 border-t pt-4">
                                <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                </svg>
                                <select
                                    id="event-type"
                                    class="flex-1 bg-transparent border-none focus:ring-0 text-gray-900"
                                >
                                    <option value="training">Training</option>
                                    <option value="competition">Wettkampf / Turnier</option>
                                    <option value="meeting">Versammlung / Besprechung</option>
                                    <option value="other">Sonstiges</option>
                                </select>
                            </div>
                            <!-- Points Toggle (shown for competition, hidden for training/meeting/other) -->
                            <div id="event-points-toggle" class="hidden flex items-center justify-between border-t pt-4">
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                                    </svg>
                                    <span class="text-gray-700">Punkte vergeben</span>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="event-award-points" class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-yellow-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-yellow-500"></div>
                                </label>
                            </div>
                            <!-- Points Info for Training -->
                            <div id="event-points-info" class="border-t pt-4">
                                <div class="flex items-center gap-2 text-sm text-green-600">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                    </svg>
                                    <span>Training: Punkte werden automatisch vergeben</span>
                                </div>
                            </div>
                        </div>

                        <!-- Organizer Selection -->
                        <div class="bg-gray-50 rounded-xl p-4 space-y-4">
                            <div class="flex items-center justify-between cursor-pointer" id="event-organizer-row">
                                <div class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                                    </svg>
                                    <span class="text-gray-700">Veranstalter</span>
                                </div>
                                <span id="event-organizer-display" class="text-gray-500 text-sm">Du</span>
                            </div>
                            <!-- Organizer Dropdown (hidden by default) -->
                            <div id="event-organizer-dropdown" class="hidden border-t pt-4">
                                <p class="text-xs text-gray-500 mb-3">W√§hle Veranstalter aus (Coaches/Trainer)</p>
                                <div id="event-organizer-list" class="space-y-2 max-h-48 overflow-y-auto">
                                    <!-- Filled dynamically -->
                                </div>
                            </div>
                        </div>

                        <!-- Attachments -->
                        <div class="bg-gray-50 rounded-xl p-4 space-y-4">
                            <div class="flex items-center justify-between cursor-pointer" id="event-attachment-row">
                                <div class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"/>
                                    </svg>
                                    <span class="text-gray-700">Anhang hinzuf√ºgen</span>
                                </div>
                                <span id="event-attachment-count" class="text-gray-400 text-sm"></span>
                            </div>
                            <div id="event-attachment-section" class="hidden border-t pt-4 space-y-3">
                                <div class="flex gap-2">
                                    <button type="button" id="event-attach-photo-btn" class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition">
                                        <i class="fas fa-image text-indigo-500"></i> Foto
                                    </button>
                                    <button type="button" id="event-attach-camera-btn" class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition">
                                        <i class="fas fa-camera text-indigo-500"></i> Kamera
                                    </button>
                                    <button type="button" id="event-attach-pdf-btn" class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition">
                                        <i class="fas fa-file-pdf text-red-500"></i> PDF
                                    </button>
                                </div>
                                <input type="file" id="event-attachment-photo-input" accept="image/*" class="hidden" multiple />
                                <input type="file" id="event-attachment-camera-input" accept="image/*" capture="environment" class="hidden" />
                                <input type="file" id="event-attachment-pdf-input" accept=".pdf" class="hidden" multiple />
                                <div id="event-attachment-preview" class="space-y-2">
                                    <!-- Attachment previews rendered dynamically -->
                                </div>
                            </div>
                        </div>

                        <!-- Date & Time -->
                        <div class="bg-gray-50 rounded-xl p-4 space-y-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span class="text-gray-700">Beginn</span>
                                </div>
                                <div class="flex gap-2">
                                    <input type="date" id="event-start-date" required class="px-3 py-1 rounded-lg border border-gray-200 text-sm"/>
                                    <input type="time" id="event-start-time" required class="px-3 py-1 rounded-lg border border-gray-200 text-sm"/>
                                </div>
                            </div>
                            <div class="flex items-center justify-between border-t pt-4">
                                <div class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    </svg>
                                    <span class="text-gray-700">Treffen</span>
                                </div>
                                <input type="time" id="event-meeting-time" class="px-3 py-1 rounded-lg border border-gray-200 text-sm" placeholder="Optional"/>
                            </div>
                            <div class="flex items-center justify-between border-t pt-4">
                                <div class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span class="text-gray-700">Ende</span>
                                </div>
                                <input type="time" id="event-end-time" class="px-3 py-1 rounded-lg border border-gray-200 text-sm" placeholder="Optional"/>
                            </div>
                            <div class="flex items-center gap-3 border-t pt-4">
                                <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                <input
                                    type="text"
                                    id="event-location"
                                    placeholder="Ort hinzuf√ºgen"
                                    class="flex-1 bg-transparent border-none focus:ring-0 text-gray-900 placeholder-gray-400"
                                />
                            </div>
                        </div>

                        <!-- Recurring Settings (hidden by default) -->
                        <div id="event-recurring-settings" class="bg-purple-50 rounded-xl p-4 space-y-4 hidden">
                            <h4 class="font-semibold text-purple-900 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                </svg>
                                Wiederholung
                            </h4>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700">Wiederholen</span>
                                <select id="event-repeat-type" class="px-3 py-1 rounded-lg border border-gray-200 text-sm">
                                    <option value="weekly">W√∂chentlich</option>
                                    <option value="biweekly">Alle 2 Wochen</option>
                                    <option value="monthly">Monatlich</option>
                                </select>
                            </div>
                            <div class="flex items-center justify-between border-t pt-4">
                                <span class="text-gray-700">Wiederholung stoppen</span>
                                <input type="date" id="event-repeat-end" class="px-3 py-1 rounded-lg border border-gray-200 text-sm"/>
                            </div>
                        </div>

                        <!-- More Settings (collapsible) -->
                        <div class="bg-gray-50 rounded-xl overflow-hidden">
                            <button type="button" id="event-more-settings-toggle" class="w-full flex items-center justify-between p-4 hover:bg-gray-100 transition">
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Mehr Einstellungen</h4>
                                <svg id="event-more-settings-chevron" class="w-5 h-5 text-gray-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                            <div id="event-more-settings-content" class="hidden px-4 pb-4 space-y-4">

                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700">Max. Teilnehmer</span>
                                    <input type="number" id="event-max-participants" min="1" placeholder="Keine" class="w-24 px-3 py-1 rounded-lg border border-gray-200 text-sm text-right"/>
                                </div>
                                <div class="flex items-center justify-between border-t pt-4">
                                    <span class="text-gray-700">Antwort-Deadline</span>
                                    <input type="datetime-local" id="event-response-deadline" class="px-3 py-1 rounded-lg border border-gray-200 text-sm"/>
                                </div>
                                <div class="flex items-center justify-between border-t pt-4">
                                    <span class="text-gray-700">Einladung verschicken</span>
                                    <select id="event-send-invitation" class="px-3 py-1 rounded-lg border border-gray-200 text-sm">
                                        <option value="now">Sofort</option>
                                        <option value="scheduled">Geplant (Datum)</option>
                                        <option value="none">Keine Einladung</option>
                                    </select>
                                </div>
                                <div id="event-scheduled-send" class="hidden border-t pt-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700">Senden am</span>
                                        <input type="datetime-local" id="event-send-at" class="px-3 py-1 rounded-lg border border-gray-200 text-sm"/>
                                    </div>
                                </div>
                                <div id="event-lead-time-send" class="hidden border-t pt-4">
                                    <p class="text-xs text-gray-500 mb-3">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        Ideal f√ºr wiederkehrende Events: Einladungen werden automatisch vor jedem Termin versendet.
                                    </p>
                                    <div class="flex items-center gap-2">
                                        <input type="number" id="event-lead-time-value" min="1" max="30" value="3"
                                               class="w-20 px-3 py-1 rounded-lg border border-gray-200 text-sm text-center"/>
                                        <select id="event-lead-time-unit" class="flex-1 px-3 py-1 rounded-lg border border-gray-200 text-sm">
                                            <option value="hours">Stunden vorher</option>
                                            <option value="days" selected>Tage vorher</option>
                                            <option value="weeks">Wochen vorher</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Automatic Reminder -->
                                <div class="flex items-center justify-between border-t pt-4">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                                        </svg>
                                        <span class="text-gray-700">Automatische Erinnerung</span>
                                    </div>
                                    <button type="button" id="event-auto-reminder-btn" class="px-3 py-1 rounded-lg border border-gray-200 text-sm text-gray-500 hover:bg-gray-100 transition">
                                        Deaktiviert
                                    </button>
                                </div>
                                <div id="event-reminder-info" class="hidden text-xs text-amber-600 bg-amber-50 p-2 rounded-lg">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Die automatische Erinnerung ist deaktiviert, wenn alle Personen standardm√§√üig als anwesend markiert sind oder wenn von der Versandzeit der Einladungen bis zur Startzeit weniger als 48 Stunden vergangen sind.
                                </div>

                                <!-- Default Participation Status -->
                                <div class="flex items-center justify-between border-t pt-4">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        <span class="text-gray-700">Standard-Teilnahmestatus</span>
                                    </div>
                                    <select id="event-default-status" class="px-3 py-1 rounded-lg border border-gray-200 text-sm">
                                        <option value="pending">Unbeantwortet</option>
                                        <option value="accepted">Teilnehmend</option>
                                    </select>
                                </div>
                                <div id="event-default-status-hint" class="text-xs text-gray-500 bg-gray-100 p-2 rounded-lg">
                                    Empf√§nger werden standardm√§√üig als unbeantwortet eingetragen. Sie m√ºssen ihre Teilnahme best√§tigen oder ablehnen.
                                </div>

                                <!-- Comments Toggle -->
                                <div class="flex items-center justify-between border-t pt-4">
                                    <span class="text-gray-700">Kommentare</span>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="event-comments-enabled" checked class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>

        <!-- ========== END EVENT MODALS ========== -->

        <!-- Footer -->
        <footer class="mt-12 pb-6 px-4">
            <div class="max-w-4xl mx-auto">
                <!-- Bug Report Notice -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <div class="flex items-start gap-3">
                        <i class="fas fa-bug text-blue-600 text-xl mt-1"></i>
                        <div class="flex-1">
                            <h3 class="text-sm font-semibold text-blue-900 mb-1">Bug gefunden?</h3>
                            <p class="text-xs text-blue-800">
                                Hilf uns, die App zu verbessern! Sende Fehlerberichte und Feedback an
                                <a href="mailto:support@sc-champions.de" class="font-semibold underline hover:text-blue-900">
                                    support@sc-champions.de
                                </a>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Links -->
                <div class="text-center text-xs text-gray-600 space-y-2">
                    <div class="flex justify-center items-center gap-4">
                        <a href="/docs/impressum.html" class="hover:text-indigo-600 transition-colors">
                            Impressum
                        </a>
                        <span class="text-gray-400">‚Ä¢</span>
                        <a href="/docs/datenschutz.html" class="hover:text-indigo-600 transition-colors">
                            Datenschutzerkl√§rung
                        </a>
                    </div>
                    <p class="text-gray-500">
                        ¬© 2025 SC Champions. Alle Rechte vorbehalten.
                    </p>
                    <p class="text-gray-400 text-xs italic mt-2">
                        Hinweis: SC Champions ist derzeit ein Forschungsprojekt im Rahmen einer Bachelorarbeit und befindet sich in der Testphase.
                    </p>
                </div>
            </div>
        </footer>

        <script src="/js/update-checker.js"></script>
        <script src="/js/pwa-register.js"></script>
        <script type="module" src="/js/notifications.js"></script>
        <script type="module" src="/js/spa-enhancer.js"></script>

        <!-- Exercise Form Toggle Script -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const toggleBtn = document.getElementById('toggle-exercise-form');
                const formContainer = document.getElementById('exercise-form-container');
                const formIcon = document.getElementById('exercise-form-icon');

                if (toggleBtn && formContainer && formIcon) {
                    toggleBtn.addEventListener('click', function() {
                        const isHidden = formContainer.classList.contains('hidden');

                        if (isHidden) {
                            formContainer.classList.remove('hidden');
                            formIcon.style.transform = 'rotate(180deg)';
                        } else {
                            formContainer.classList.add('hidden');
                            formIcon.style.transform = 'rotate(0deg)';
                        }
                    });
                }
            });
        </script>

        <!-- Table Tennis Exercise Builder for animation playback -->
        <script src="/js/table-tennis-exercise-builder.js"></script>

        <!-- Safety timeout: show content even if CDN modules fail to load -->
        <script>
            setTimeout(function() {
                var loader = document.getElementById('page-loader');
                var content = document.getElementById('main-content');
                if (loader && loader.style.display !== 'none') {
                    console.warn('[Coach] Module init timed out, force-showing content');
                    loader.style.display = 'none';
                    if (content) content.style.display = 'block';
                }
                if (window.hideSplash) window.hideSplash();
            }, 8000);
        </script>
        <script type="module">
            // Initialize i18n
            import { initI18n, translatePage, setupAutoTranslate } from '/js/i18n.js';

            async function initializeI18n() {
                try {
                    await initI18n();
                    setupAutoTranslate();
                    translatePage();
                    document.documentElement.lang = localStorage.getItem('app_language') || 'de';
                } catch (e) {
                    console.warn('[Coach] i18n init failed:', e.message);
                }
            }

            initializeI18n();
        </script>

        <!-- Firebase: <script type="module" src="/js/coach.js"></script> -->
        <script type="module" src="/js/coach-supabase.js"></script>
    </body>
</html>
