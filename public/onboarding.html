<!doctype html>
<html lang="de">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Profil vervollständigen - TTV Champions</title>

        <!-- PWA Meta Tags -->
        <link rel="manifest" href="/manifest.json" />
        <meta name="theme-color" content="#1e3a5f" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="TTV Champions" />
        <link rel="apple-touch-icon" href="/icons/icon-152x152.png" />
        <meta name="mobile-web-app-capable" content="yes" />

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-H2R9ZJYQ06"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-H2R9ZJYQ06');
        </script>

        <script src="https://cdn.tailwindcss.com"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <style>
            body {
                font-family: 'Inter', sans-serif;
            }
        </style>
    </head>
    <body class="bg-gray-100 flex items-center justify-center min-h-screen">
        <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-xl shadow-lg">
            <div>
                <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                    Vervollständige dein Profil
                </h2>
                <p class="mt-2 text-center text-sm text-gray-600">
                    Fast geschafft! Wir brauchen nur noch ein paar Infos.
                </p>
            </div>
            <form id="onboarding-form" class="mt-8 space-y-6">
                <div class="rounded-md shadow-sm">
                    <div class="flex flex-col items-center space-y-4 mb-6">
                        <img
                            id="profile-image-preview"
                            src="https://placehold.co/96x96/e2e8f0/64748b?text=Foto"
                            alt="Profilbild Vorschau"
                            class="h-24 w-24 rounded-full object-cover"
                        />
                        <div>
                            <label
                                for="photo-upload"
                                class="cursor-pointer bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"
                            >
                                <span>Profilbild auswählen</span>
                                <input
                                    id="photo-upload"
                                    type="file"
                                    class="sr-only"
                                    accept="image/*"
                                />
                            </label>
                        </div>
                    </div>
                    <div>
                        <label
                            for="firstName"
                            class="block text-sm font-medium text-gray-700 mb-1 px-3"
                            >Vorname</label
                        >
                        <input
                            id="firstName"
                            name="firstName"
                            type="text"
                            required
                            class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                            placeholder="Vorname"
                        />
                    </div>
                    <div>
                        <label
                            for="lastName"
                            class="block text-sm font-medium text-gray-700 mb-1 px-3"
                            >Nachname</label
                        >
                        <input
                            id="lastName"
                            name="lastName"
                            type="text"
                            required
                            class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                            placeholder="Nachname"
                        />
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 px-3"
                            >Geburtsdatum</label
                        >
                        <div class="flex gap-2">
                            <select
                                id="birthdate-day"
                                name="birthdate-day"
                                required
                                class="appearance-none rounded-md relative block w-1/3 px-3 py-2 border border-gray-300 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                            >
                                <option value="">Tag</option>
                            </select>
                            <select
                                id="birthdate-month"
                                name="birthdate-month"
                                required
                                class="appearance-none rounded-md relative block w-1/3 px-3 py-2 border border-gray-300 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                            >
                                <option value="">Monat</option>
                            </select>
                            <select
                                id="birthdate-year"
                                name="birthdate-year"
                                required
                                class="appearance-none rounded-md relative block w-1/3 px-3 py-2 border border-gray-300 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                            >
                                <option value="">Jahr</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label
                            for="gender"
                            class="block text-sm font-medium text-gray-700 mb-1 px-3"
                            >Geschlecht</label
                        >
                        <select
                            id="gender"
                            name="gender"
                            required
                            class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                        >
                            <option value="">Geschlecht wählen</option>
                            <option value="male">Männlich</option>
                            <option value="female">Weiblich</option>
                            <option value="diverse">Divers</option>
                        </select>
                    </div>
                    <div>
                        <label
                            for="qttr-points"
                            class="block text-sm font-medium text-gray-700 mb-1 px-3"
                            >QTTR-Punkte (optional)</label
                        >
                        <input
                            id="qttr-points"
                            name="qttr-points"
                            type="number"
                            min="0"
                            max="3500"
                            placeholder="z.B. 1500"
                            class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                        />
                        <p class="mt-1 text-xs text-gray-500 px-3">
                            Falls du bereits QTTR-Punkte (Q-TTR) hast, trage sie hier ein. Dies hilft bei der Elo-Berechnung.
                        </p>
                    </div>
                </div>
                <div>
                    <button
                        type="submit"
                        id="submit-button"
                        class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                    >
                        Profil speichern
                    </button>
                </div>
                <p id="error-message" class="mt-2 text-center text-sm text-red-600"></p>
            </form>
        </div>

        <!-- Club Selection Dialog (nur für Spieler ohne clubId) -->
        <div id="club-selection-dialog" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
            <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-2xl">
                <div>
                    <h2 class="text-center text-2xl font-bold text-gray-900">
                        Bist du bereits in einem Tischtennisverein?
                    </h2>
                    <p class="mt-2 text-center text-sm text-gray-600">
                        Du kannst später in den Einstellungen einem Verein beitreten.
                    </p>
                </div>

                <div class="space-y-4">
                    <button
                        id="has-club-btn"
                        class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md flex items-center justify-center"
                    >
                        <i class="fas fa-users mr-2"></i>
                        Ja, ich bin in einem Verein
                    </button>

                    <button
                        id="no-club-btn"
                        class="w-full bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors shadow-md flex items-center justify-center"
                    >
                        <i class="fas fa-forward mr-2"></i>
                        Nein, noch nicht
                    </button>
                </div>

                <!-- Club Dropdown (wird nach Klick auf "Ja" angezeigt) -->
                <div id="club-dropdown-container" class="hidden space-y-4">
                    <div class="border-t border-gray-200 pt-4">
                        <label for="club-select" class="block text-sm font-medium text-gray-700 mb-2">
                            Wähle deinen Verein aus:
                        </label>
                        <select
                            id="club-select"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                        >
                            <option value="">-- Verein auswählen --</option>
                            <!-- Wird dynamisch gefüllt -->
                        </select>
                    </div>

                    <button
                        id="request-club-btn"
                        class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors shadow-md disabled:bg-gray-400 disabled:cursor-not-allowed"
                        disabled
                    >
                        Beitrittsanfrage senden
                    </button>

                    <button
                        id="back-to-choice-btn"
                        class="w-full bg-gray-100 text-gray-600 font-medium py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors"
                    >
                        Zurück
                    </button>
                </div>

                <p id="club-error-message" class="text-center text-sm text-red-600"></p>
            </div>
        </div>

        <script src="/js/update-checker.js"></script>
        <script type="module" src="/js/spa-enhancer.js"></script>
        <script type="module" src="/js/onboarding.js"></script>
    </body>
</html>
